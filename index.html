<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>friend.tech</title>
  <link href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="images/logo2.png">
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      background: #fff;
      min-width: 0;
    }

    .container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .content {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 10vh;
    }

    .logo {
      width: 100px;
      margin-bottom: 48px;
    }

    h1 {
      font-size: 2.5rem;
      margin: 0 0 18px 0;
      font-weight: 700;
    }

    .purple {
      color: #a020f0;
    }

    .blue {
      color: #00bfff;
    }

    .black {
      color: #222;
    }

    .subtitle {
      color: #888;
      margin: 0 0 40px 0;
      font-size: 1.2rem;
    }

    .login-btn {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 16px 80px;
      font-size: 1.2rem;
      cursor: pointer;
      font-weight: 500;
      margin-bottom: 0;
      transition: background 0.2s;
    }

    .login-btn:hover {
      background: #0099cc;
    }

    .footer {
      position: fixed;
      bottom: 30px;
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 60px;
    }

    .footer-link {
      color: #00bfff;
      text-decoration: none;
      font-size: 1rem;
      transition: text-decoration 0.2s;
    }

    .footer-link:hover {
      text-decoration: underline;
    }

    /* --- Modal styles --- */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #fff;
      padding: 32px 24px;
      border-radius: 12px;
      min-width: 320px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .close {
      position: absolute;
      right: 16px;
      top: 12px;
      font-size: 2rem;
      cursor: pointer;
      color: #888;
    }

    .twitter-btn {
      background: #1da1f2;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 12px 32px;
      font-size: 1rem;
      margin-bottom: 16px;
      cursor: pointer;
    }

    .divider {
      margin: 12px 0;
      color: #aaa;
      font-size: 0.9rem;
    }

    #registerForm {
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 100%;
    }

    #registerForm input {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }

    .register-btn {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px;
      font-size: 1rem;
      cursor: pointer;
    }

    /* --- Wallet styles --- */
    .wallet-section {
      padding: 40px;
    }

    .wallet-header {
      display: flex;
      gap: 60px;
      margin-bottom: 40px;
      justify-content: center;
      /* Центрируем элементы по горизонтали */
      align-items: center;
      /* Центрируем элементы по вертикали */
    }

    .wallet-header-coins {
      text-align: center;
      /* Центрируем текст внутри элементов */
    }

    .wallet-header>div {
      display: flex;
      flex-direction: column;
      align-items: center;
      /* Центрируем содержимое каждого div */
    }

    .wallet-label {
      color: #888;
      font-size: 1rem;
    }

    .wallet-value,
    .wallet-post-price {
      font-size: 2rem;
      font-weight: bold;
      color: #222;
    }

    .wallet-post-price {
      color: #00bfff;
    }

    .wallet-grid-3x2 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(2, auto);
      gap: 48px 80px;
      justify-items: center;
      align-items: start;
      max-width: 900px;
      margin: 0 auto;
    }

    .wallet-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 160px;
      background: none;
    }

    .wallet-icon {
      margin-bottom: 8px;
      display: block;
    }

    .wallet-item-label {
      color: #888;
      font-size: 1rem;
      margin-bottom: 2px;
      background: #f5f5f5;
      border-radius: 6px;
      padding: 2px 10px;
      margin-top: 2px;
    }

    .wallet-item-value {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 8px;
      margin-top: 2px;
      color: #00bfff;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .wallet-btn {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 8px 18px;
      font-size: 1rem;
      cursor: pointer;
      margin-bottom: 8px;
      margin-top: 4px;
      font-weight: 500;
      box-shadow: 0 2px 8px rgba(0, 191, 255, 0.08);
      transition: background 0.2s;
    }

    .wallet-btn:hover {
      background: #0099cc;
    }

    @media (max-width: 1200px) {
      .wallet-grid-3x2 {
        max-width: 98vw;
      }
    }

    @media (max-width: 900px) {
      .wallet-grid-3x2 {
        gap: 32px 24px;
        max-width: 100vw;
      }

      .main-content {
        padding-left: 0;
        padding-right: 0;
      }
    }

    @media (max-width: 700px) {
      .wallet-grid-3x2 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: repeat(3, auto);
      }

      .wallet-item {
        min-width: 0;
      }

      .wallet-icon,
      .discover-avatar,
      .club-chat-avatar {
        width: 40px !important;
        height: 40px !important;
      }

      .sidebar {
        width: 60px;
        padding-top: 12px;
      }

      .sidebar-logo {
        margin-bottom: 16px;
      }

      .sidebar-item {
        padding: 12px 0 12px 10px;
        font-size: 1rem;
      }

      .main-app {
        flex-direction: column;
      }

      .main-content {
        padding: 16px 0 0 0;
      }

      .club-chat-modal-content,
      .create-club-modal-content {
        max-width: 98vw;
        min-width: 0;
        padding: 0 2vw;
      }
    }

    @media (max-width: 500px) {
      .wallet-grid-3x2 {
        grid-template-columns: 1fr;
        grid-template-rows: none;
        gap: 24px 0;
      }

      .wallet-item {
        min-width: 0;
      }

      .wallet-icon,
      .discover-avatar,
      .club-chat-avatar {
        width: 32px !important;
        height: 32px !important;
      }

      .sidebar {
        display: none;
      }

      .main-app {
        flex-direction: column;
      }

      .main-content {
        padding: 8px 0 0 0;
      }

      .modal-content,
      .club-chat-modal-content,
      .create-club-modal-content {
        max-width: 100vw;
        min-width: 0;
        border-radius: 0;
        padding: 0 2vw;
      }

      .chat-header,
      .chat-tabs,
      .chat-notify,
      .chat-list,
      .wallet-header,
      .wallet-grid,
      .discover-tabs,
      .discover-list {
        padding-left: 2vw !important;
        padding-right: 2vw !important;
      }

      .club-chat-header,
      .club-chat-form {
        padding-left: 2vw !important;
        padding-right: 2vw !important;
      }

      .club-chat-messages {
        padding-left: 2vw !important;
        padding-right: 2vw !important;
      }

      .create-club-photo-label {
        width: 80px;
        height: 80px;
      }

      .register-btn,
      .wallet-btn,
      .create-club-btn,
      .chat-tab,
      .discover-tab,
      .chat-notify-btn {
        font-size: 1rem;
        padding: 10px 0;
      }

      .modal {
        align-items: flex-end;
      }
    }

    /* --- Main app layout styles --- */
    .main-app {
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 180px;
      background: #fafbfc;
      border-right: 1px solid #eee;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 32px;
    }

    .sidebar-logo {
      margin-bottom: 40px;
    }

    .sidebar-menu {
      width: 100%;
    }

    .sidebar-item {
      padding: 16px 0 16px 32px;
      font-size: 1.1rem;
      color: #888;
      cursor: pointer;
      border-left: 4px solid transparent;
      transition: background 0.2s, color 0.2s, border-color 0.2s;
    }

    .sidebar-item.active {
      color: #00bfff;
      background: #eaf7fd;
      border-left: 4px solid #00bfff;
      font-weight: 600;
    }

    .main-content {
      flex: 1;
      padding: 40px 0 0 0;
    }

    /* --- Chat tab styles --- */
    .chat-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .chat-search {
      flex: 1;
      padding: 10px 16px;
      border: 1px solid #eee;
      border-radius: 8px;
      font-size: 1rem;
    }

    .chat-bell {
      font-size: 1.5rem;
      color: #bbb;
      margin-left: auto;
    }

    .chat-tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }

    .chat-tab {
      background: #f5f5f5;
      border: none;
      border-radius: 8px;
      padding: 8px 18px;
      font-size: 1rem;
      color: #00bfff;
      cursor: pointer;
      font-weight: 500;
    }

    .chat-tab.active {
      background: #00bfff;
      color: #fff;
    }

    .chat-notify {
      background: #00bfff;
      color: #fff;
      border-radius: 8px;
      padding: 10px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
    }

    .chat-notify-btn {
      background: #fff;
      color: #00bfff;
      border: none;
      border-radius: 6px;
      padding: 4px 16px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: 500;
    }

    .chat-list {
      margin-top: 12px;
    }

    .chat-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .chat-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }

    .chat-info {
      flex: 1;
    }

    .chat-name {
      font-weight: 600;
      color: #222;
    }

    .chat-msg {
      color: #aaa;
      font-size: 0.95rem;
    }

    .chat-price {
      color: #bbb;
      font-size: 0.95rem;
    }

    /* --- Discover styles --- */
    .discover-tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
      margin-left: 8px;
    }

    .discover-tab {
      background: #f5f5f5;
      border: none;
      border-radius: 8px;
      padding: 8px 18px;
      font-size: 1rem;
      color: #00bfff;
      cursor: pointer;
      font-weight: 500;
    }

    .discover-tab.active {
      background: #00bfff;
      color: #fff;
    }

    .discover-list {
      max-width: 600px;
      margin: 0 auto;
    }

    .discover-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .discover-rank {
      width: 28px;
      text-align: right;
      font-size: 1.1rem;
      color: #bbb;
      font-weight: 600;
    }

    .discover-avatar {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      object-fit: cover;
    }

    .discover-info {
      flex: 1;
      min-width: 0;
    }

    .discover-title {
      font-weight: 600;
      color: #222;
      font-size: 1.05rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .discover-desc {
      color: #aaa;
      font-size: 0.95rem;
    }

    .discover-price {
      color: #00bfff;
      font-size: 0.98rem;
      font-weight: 500;
      margin-left: 8px;
      white-space: nowrap;
    }

    /* --- Create club modal styles --- */
    .create-club-modal-content {
      max-width: 600px;
      width: 100%;
      padding: 32px 32px 24px 32px;
      border-radius: 18px;
      position: relative;
    }

    .create-club-form {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .create-club-photo-label {
      display: block;
      width: 120px;
      height: 120px;
      margin-bottom: 8px;
      cursor: pointer;
    }

    .create-club-photo-preview {
      width: 100%;
      height: 100%;
      background: #f5f5f5;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #aaa;
      font-size: 1.1rem;
      text-align: center;
      border: 1.5px dashed #e0e0e0;
      cursor: pointer;
    }

    .create-club-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 0;
    }

    .create-club-input {
      font-size: 1.1rem;
      padding: 10px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 0;
      background: #fff;
    }

    .create-club-input[type="text"] {
      flex: 1;
    }

    .create-club-input[type="number"] {
      width: 80px;
    }

    .create-club-section-label {
      color: #888;
      font-size: 1rem;
      margin-bottom: 6px;
      margin-top: 8px;
    }

    .create-club-curves {
      display: flex;
      gap: 18px;
      margin-bottom: 0;
    }

    .curve-option {
      border: 2px solid #eee;
      border-radius: 10px;
      padding: 8px 18px;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: border 0.2s;
    }

    .curve-option.selected {
      border: 2px solid #00bfff;
      background: #eaf7fd;
    }

    .curve-option svg {
      margin-bottom: 4px;
    }

    .create-club-btn {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 16px 0;
      font-size: 1.15rem;
      font-weight: 600;
      margin-top: 18px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .create-club-btn:hover {
      background: #0099cc;
    }

    /* --- Club chat modal styles --- */
    .club-chat-modal-content {
      max-width: 800px;
      width: 100%;
      min-height: 500px;
      padding: 0;
      border-radius: 18px;
      position: relative;
      display: flex;
      flex-direction: column;
      background: #fff;
    }

    .club-chat-header {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 18px 28px 10px 28px;
      border-bottom: 1px solid #f0f0f0;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .club-chat-avatar {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      object-fit: cover;
    }

    .club-chat-title {
      font-size: 1.15rem;
      font-weight: 600;
      color: #222;
    }

    .club-chat-messages {
      flex: 1;
      padding: 18px 28px 12px 28px;
      overflow-y: auto;
      background: #fff;
      min-height: 200px;
      max-height: 400px;
    }

    .club-chat-message {
      margin-bottom: 12px;
      display: flex;
      align-items: flex-end;
      gap: 8px;
    }

    .club-chat-message.me {
      flex-direction: row-reverse;
    }

    .club-chat-bubble {
      background: #eaf7fd;
      color: #222;
      border-radius: 16px;
      padding: 8px 16px;
      max-width: 60%;
      font-size: 1.05rem;
      word-break: break-word;
    }

    .club-chat-message.me .club-chat-bubble {
      background: #00bfff;
      color: #fff;
    }

    .club-chat-form {
      display: flex;
      align-items: center;
      border-top: 1px solid #f0f0f0;
      padding: 12px 28px;
      background: #fafbfc;
    }

    #clubChatInput {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1.05rem;
      margin-right: 10px;
    }

    .club-chat-send-btn {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 18px;
      font-size: 1.2rem;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s;
    }

    .club-chat-send-btn:hover {
      background: #0099cc;
    }

    /* --- Fullscreen Web3 Chat Styles --- */
    .fullscreen-chat {
      display: none;
      position: fixed;
      z-index: 5000;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: #fff;
      flex-direction: column;
    }

    .fschat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 24px;
      height: 64px;
      border-bottom: 1px solid #f0f0f0;
      background: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .fschat-header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .fschat-back {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      color: #00bfff;
      margin-right: 4px;
    }

    .fschat-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .fschat-title {
      font-size: 1.15rem;
      font-weight: 600;
      color: #222;
      margin-left: 2px;
    }

    .fschat-header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .fschat-balance {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 18px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .fschat-menu-wrap {
      position: relative;
    }

    .fschat-menu-btn {
      background: none;
      border: none;
      font-size: 1.6rem;
      color: #888;
      cursor: pointer;
      padding: 0 8px;
    }

    .fschat-menu {
      display: none;
      position: absolute;
      right: 0;
      top: 32px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.07);
      min-width: 180px;
      border: 1px solid #eee;
    }

    .fschat-menu-item {
      padding: 12px 18px;
      cursor: pointer;
      color: #222;
      font-size: 1rem;
    }

    .fschat-menu-item:hover {
      background: #f5f5f5;
    }

    .fschat-menu-wrap.open .fschat-menu {
      display: block;
    }

    .fschat-messages {
      flex: 1;
      overflow-y: auto;
      background: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 32px 0 0 0;
    }

    .fschat-message-row {
      width: 100%;
      display: flex;
      margin-bottom: 32px;
    }

    .fschat-message-row.me {
      justify-content: flex-end;
    }

    .fschat-message {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      max-width: 420px;
    }

    .fschat-message.me {
      align-items: flex-end;
    }

    .fschat-msg-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 2px;
    }

    .fschat-msg-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
    }

    .fschat-msg-nick {
      font-weight: 600;
      font-size: 1rem;
      color: #222;
    }

    .fschat-msg-time {
      color: #aaa;
      font-size: 0.92rem;
      margin-left: 4px;
    }

    .fschat-bubble {
      background: #eaf7fd;
      color: #222;
      border-radius: 18px;
      padding: 12px 18px;
      font-size: 1.08rem;
      word-break: break-word;
      margin-bottom: 2px;
    }

    .fschat-message.me .fschat-bubble {
      background: #fff;
      color: #222;
      border: 1px solid #eaf7fd;
    }

    .fschat-tip {
      color: #aaa;
      font-size: 0.98rem;
      text-align: center;
      margin: 0 0 8px 0;
    }

    .fschat-form {
      display: flex;
      align-items: center;
      gap: 8px;
      border-top: 1px solid #f0f0f0;
      background: #fff;
      padding: 12px 24px;
      position: sticky;
      bottom: 0;
    }

    .fschat-emoji {
      background: none;
      border: none;
      font-size: 1.4rem;
      cursor: pointer;
      color: #888;
    }

    #fullscreenChatInput {
      flex: 1;
      padding: 12px 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1.08rem;
    }

    .fschat-send {
      background: #00bfff;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 1.3rem;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
    }

    .fschat-send:hover {
      background: #0099cc;
    }

    @media (max-width: 700px) {

      .fschat-header,
      .fschat-form {
        padding: 0 8px;
      }

      .fschat-messages {
        padding-top: 16px;
      }

      .fschat-message {
        max-width: 98vw;
      }
    }

    @media (max-width: 500px) {

      .fschat-header,
      .fschat-form {
        padding: 0 2vw;
      }

      .fschat-messages {
        padding-top: 8px;
      }

      .fschat-message {
        max-width: 99vw;
      }
    }

    /* --- Emoji panel styles --- */
    .fschat-emoji-panel {
      position: absolute;
      bottom: 56px;
      left: 12px;
      background: #fff;
      border: 1px solid #eee;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.07);
      padding: 8px 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      z-index: 10000;
      min-width: 180px;
    }

    .fschat-emoji-btn {
      background: none;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      padding: 4px 6px;
      border-radius: 6px;
      transition: background 0.15s;
    }

    .fschat-emoji-btn:hover {
      background: #eaf7fd;
    }

    .fschat-img-btn {
      background: none;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      color: #888;
    }

    .fschat-img-btn:hover {
      color: #00bfff;
    }

    .fschat-img-preview {
      max-width: 180px;
      max-height: 120px;
      border-radius: 10px;
      margin: 6px 0;
      display: block;
    }

    /* --- Wallet profile styles --- */
    .wallet-profile-block {
      background: #fff;
      border-radius: 18px;
      margin: 0 auto 32px auto;
      max-width: 700px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.03);
      padding: 32px 32px 24px 32px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .wallet-profile-header {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    .wallet-profile-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      object-fit: cover;
    }

    .wallet-profile-info {
      flex: 1;
    }

    .wallet-profile-name {
      font-size: 1.3rem;
      font-weight: 700;
      color: #222;
    }

    .wallet-profile-handle {
      color: #aaa;
      font-size: 1.05rem;
      margin-left: 8px;
    }

    .wallet-profile-addr {
      color: #888;
      font-size: 1.05rem;
      margin: 4px 0;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .wallet-copy-btn {
      background: none;
      border: none;
      font-size: 1.1rem;
      cursor: pointer;
      color: #00bfff;
    }

    .wallet-profile-twitter {
      color: #00bfff;
      font-size: 1.05rem;
      margin-bottom: 2px;
    }

    .wallet-profile-actions {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .wallet-profile-btn {
      background: #fff;
      color: #00bfff;
      border: 1px solid #00bfff;
      border-radius: 8px;
      padding: 6px 18px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .wallet-profile-btn:hover {
      background: #eaf7fd;
    }

    .wallet-profile-balances {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .wallet-profile-fees {
      color: #888;
      font-size: 1.05rem;
    }

    .wallet-profile-fee-val {
      color: #00bfff;
      font-weight: 600;
      margin-left: 6px;
    }

    .wallet-profile-balance-row {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .wallet-profile-balance {
      color: #00bfff;
      font-weight: 600;
      margin-left: 6px;
    }

    .wallet-profile-withdraw {
      background: #eaf7fd;
      color: #00bfff;
      border: none;
      border-radius: 8px;
      padding: 6px 18px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      margin-left: auto;
      transition: background 0.2s;
    }

    .wallet-profile-withdraw:hover {
      background: #00bfff;
      color: #fff;
    }

    .wallet-profile-fund-label {
      color: #888;
      font-size: 1.05rem;
      margin-top: 12px;
    }

    .wallet-profile-fund-row {
      display: flex;
      gap: 12px;
      margin: 8px 0 0 0;
    }

    .wallet-fund-btn {
      flex: 1;
      font-size: 1.15rem;
      font-weight: 600;
      border-radius: 10px;
      border: none;
      padding: 14px 0;
      cursor: pointer;
      margin: 0;
      transition: background 0.2s, color 0.2s;
    }

    .wallet-fund-base {
      background: #0052ff;
      color: #fff;
    }

    .wallet-fund-coinbase {
      background: #0066ff;
      color: #fff;
    }

    .wallet-fund-eth {
      background: #eee;
      color: #222;
    }

    .wallet-fund-btn:hover {
      filter: brightness(0.95);
    }

    .wallet-logout-btn {
      margin: 24px auto 0 auto;
      display: block;
      background: #fff;
      color: #888;
      border: 1.5px solid #ccc;
      border-radius: 8px;
      padding: 10px 0;
      width: 100%;
      font-size: 1.1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .wallet-logout-btn:hover {
      background: #f5f5f5;
      color: #222;
    }

    @media (max-width: 900px) {
      .wallet-profile-block {
        max-width: 99vw;
        padding: 18px 4vw 12px 4vw;
      }

      .wallet-profile-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .wallet-profile-actions {
        flex-direction: row;
        gap: 8px;
      }

      .wallet-profile-avatar {
        width: 48px;
        height: 48px;
      }
    }

    @media (max-width: 600px) {
      .wallet-profile-block {
        padding: 10px 2vw 8px 2vw;
      }

      .wallet-profile-header {
        gap: 8px;
      }

      .wallet-profile-avatar {
        width: 36px;
        height: 36px;
      }

      .wallet-profile-btn,
      .wallet-profile-withdraw,
      .wallet-fund-btn,
      .wallet-logout-btn {
        font-size: 0.98rem;
        padding: 8px 0;
      }

      .wallet-profile-fund-row {
        flex-direction: column;
        gap: 8px;
      }
    }

    /* --- Login/Register switch styles --- */
    .login-switch-row {
      display: flex;
      gap: 18px;
      justify-content: center;
      margin-top: 10px;
    }

    .login-switch-link {
      color: #00bfff;
      font-size: 0.98rem;
      text-decoration: none;
      cursor: pointer;
      transition: text-decoration 0.2s;
    }

    .login-switch-link:hover {
      text-decoration: underline;
    }

    /* Добавляем стили для hover эффекта */
    .fschat-emoji img:hover,
    .fschat-img-btn img:hover,
    .fschat-send img:hover {
      opacity: 1 !important;
    }

    /* Стили для панели эмодзи */
    .emoji-panel {
      position: absolute;
      bottom: 50px;
      left: 0;
      background: white;
      border: 1px solid #eee;
      border-radius: 8px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
      padding: 8px;
      display: none;
      grid-template-columns: repeat(8, 1fr);
      gap: 8px;
      z-index: 1000;
    }

    .emoji-btn {
      background: none;
      border: none;
      padding: 6px;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.2s;
    }

    .emoji-btn:hover {
      background-color: #f0f0f0;
    }

    .emoji-btn img {
      width: 20px;
      height: 20px;
      display: block;
    }

    /* --- Edit Profile Modal Styles --- */
    .edit-profile-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #fff;
      z-index: 1000;
    }

    .edit-profile-header {
      display: flex;
      align-items: center;
      padding: 16px;
      border-bottom: 1px solid #eee;
    }

    .edit-profile-back {
      background: none;
      border: none;
      font-size: 24px;
      padding: 8px;
      cursor: pointer;
      color: #000;
    }

    .edit-profile-title {
      font-size: 20px;
      font-weight: 600;
      margin-left: 16px;
    }

    .edit-profile-content {
      padding: 24px;
      max-width: 600px;
      margin: 0 auto;
    }

    .edit-profile-avatar-wrap {
      position: relative;
      width: 120px;
      height: 120px;
      margin: 0 auto 32px;
    }

    .edit-profile-avatar {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .edit-profile-avatar-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .edit-profile-avatar-wrap:hover .edit-profile-avatar-overlay {
      opacity: 1;
    }

    .edit-profile-camera-icon {
      width: 32px;
      height: 32px;
      filter: invert(1);
    }

    .edit-profile-form-group {
      margin-bottom: 24px;
    }

    .edit-profile-label {
      display: block;
      margin-bottom: 8px;
      color: #666;
    }

    .edit-profile-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }

    .edit-profile-save {
      width: 100%;
      padding: 14px;
      background: #00bfff;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .edit-profile-save:hover {
      background: #0099ff;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 500px;
      border-radius: 10px;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .close-button {
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      background: none;
      border: none;
    }

    .edit-profile-avatar-container {
      position: relative;
      width: 100px;
      height: 100px;
      margin: 0 auto 20px;
    }

    .edit-profile-avatar-container img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .edit-profile-avatar-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .edit-profile-avatar-overlay:hover {
      opacity: 1;
    }

    .edit-profile-form .form-group {
      margin-bottom: 15px;
    }

    .edit-profile-form label {
      display: block;
      margin-bottom: 5px;
    }

    .edit-profile-form input,
    .edit-profile-form textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .save-profile-btn {
      width: 100%;
      padding: 10px;
      background-color: #1da1f2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .save-profile-btn:hover {
      background-color: #1991db;
    }

    /* Emoji panel styles */
    .emoji-panel {
      position: absolute;
      background: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 5px;
      z-index: 1000;
    }

    .emoji-panel span {
      cursor: pointer;
      text-align: center;
      padding: 5px;
    }

    .emoji-panel span:hover {
      background-color: #f0f0f0;
      border-radius: 4px;
    }

    .emoji-trigger {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2em;
      padding: 5px;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="content">
      <!-- SVG логотип -->
      <img src="images/logo2.png" class="logo" alt="logo">
      <h1><span class="purple">Post </span><span class="black">to </span><span class="purple">coin</span></h1>
      <p class="subtitle">precious spaces online and onchain</p>
      <button class="login-btn">Log in</button>
    </div>
    <div class="footer">
      <a href="#" class="footer-link">Previously used Post? →</a>
      <a href="#" class="footer-link">Terms of Service →</a>
    </div>
  </div>
  <!-- Модальное окно -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <h2>Log in / Register</h2>
      <button class="twitter-btn" id="twitterLogin">Log in with Twitter</button>
      <div class="divider">or</div>
      <form id="registerForm">
        <input type="email" placeholder="Email" required>
        <input type="password" placeholder="Password" required>
        <button type="submit" class="register-btn">Register</button>
      </form>
      <form id="loginForm" style="display:none; margin-top: 8px;">
        <input type="email" placeholder="Email" required>
        <input type="password" placeholder="Password" required>
        <button type="submit" class="register-btn">Sign In</button>
      </form>
      <div class="login-switch-row">
        <a href="#" id="showLoginForm" class="login-switch-link">Already have an account? Sign in</a>
        <a href="#" id="showRegisterForm" class="login-switch-link" style="display:none;">No account? Register</a>
      </div>
    </div>
  </div>
  <!-- Wallet section (изначально скрыта) -->
  <div id="wallet" class="wallet-section" style="display:none;">
    <div class="wallet-header">
      <div>
        <div class="wallet-label">Wallet value</div>
        <div class="wallet-value">$1.75</div>
      </div>
      <div>
        <div class="wallet-label">$POST price</div>
        <div class="wallet-post-price">$0.04</div>
      </div>
    </div>
    <div class="wallet-grid wallet-grid-3x2">
      <div class="wallet-item">

      </div>
      <div class="wallet-item">
        <img src="images/logo2.png" alt="POST" class="wallet-icon" style="width:64px;">
        <div class="wallet-item-label">$POST</div>
        <div class="wallet-item-value">0.9</div>
        <button class="wallet-btn">Buy/Sell</button>
      </div>
      <div class="wallet-item">

      </div>



    </div>
  </div>
  <!-- Main app layout (скрыт по умолчанию) -->
  <div id="main-app" class="main-app" style="display:none;">
    <div class="sidebar">
      <div class="sidebar-logo">
        <img src="images/logo2.png" width="32" height="32" alt="logo">
      </div>
      <div class="sidebar-menu">
        <div class="sidebar-item active" data-tab="wallet">Wallet</div>
        <div class="sidebar-item" data-tab="chat">Chat</div>
        <div class="sidebar-item" data-tab="discover">Discover</div>
      </div>
    </div>
    <div class="main-content">
      <!-- Wallet tab -->
      <div id="tab-wallet" class="tab-content">
        <div class="wallet-profile-block">
          <div class="wallet-profile-header">
            <img class="wallet-profile-avatar" src="https://randomuser.me/api/portraits/men/35.jpg" alt="avatar">
            <div class="wallet-profile-info">
              <div class="wallet-profile-name">Smirnoff <span class="wallet-profile-handle">@Smirnoff_ETH</span></div>
              <div class="wallet-profile-addr">
                <span id="walletAddress">
                  <button id="connectPhantomBtn" class="connect-wallet-btn">Connect Wallet</button>
                </span>
                <button class="wallet-copy-btn" data-address="" title="Copy address" style="display:none;">
                  <img src="images/copy-icon.png" style="width:14px;height:14px;vertical-align:middle;">
                </button>
              </div>
              <div class="wallet-profile-twitter"><a href="#" style="color:#00bfff;">@Smirnoff_ETH</a> <span
                  style="color:#00bfff;">✔️</span></div>
            </div>
            <div class="wallet-profile-actions">
              <button class="wallet-profile-btn edit-profile-trigger">Edit profile</button>
              <button class="wallet-profile-btn">Sync Twitter</button>
              <button class="wallet-profile-btn">Unlink Twitter</button>
            </div>
          </div>
          <div class="wallet-profile-balances">
            <div class="wallet-profile-fees">Trading fees earned <span class="wallet-profile-fee-val"><img
                  src="images/logo2.png" style="width:14px;height:14px;vertical-align:middle;margin-right:2px;">
                0.002</span></div>
            <div class="wallet-profile-balance-row">
              <div>Wallet balance <span class="wallet-profile-balance"><img src="images/logo2.png"
                    style="width:14px;height:14px;vertical-align:middle;margin-right:2px;"> 0.001</span></div>
              <button class="wallet-profile-withdraw"><span style="color:#00bfff;">▶</span> Withdraw ETH</button>
            </div>
          </div>
          <div class="wallet-profile-fund-label">Fund your POST from</div>
          <div class="wallet-profile-fund-row">
            <button class="wallet-fund-btn wallet-fund-base">
              <img src="images/base-logo.png" style="height:20px;vertical-align:middle;margin-right:8px;">BASE
            </button>
            <button class="wallet-fund-btn wallet-fund-coinbase">
              coinbase <span style="font-size:0.9em;">PAY</span>
            </button>
            <button class="wallet-fund-btn wallet-fund-eth">
              <img src="images/ethereum-logo.png" style="height:20px;vertical-align:middle;margin-right:8px;">ethereum
            </button>
          </div>
          <button class="wallet-logout-btn">Log out</button>
        </div>
        <div class="wallet-header wallet-header-coins">
          <div>
            <div class="wallet-label">Wallet value</div>
            <div class="wallet-value">$1.75</div>
          </div>
          <div>
            <div class="wallet-label">$POST price</div>
            <div class="wallet-post-price">$0.04</div>
          </div>
        </div>
        <div class="wallet-grid wallet-grid-3x2">
          <div class="wallet-item">

          </div>
          <div class="wallet-item">
            <img src="images/logo2.png" alt="POST" class="wallet-icon" style="width:64px;">
            <div class="wallet-item-label">$POST</div>
            <div class="wallet-item-value">0.9</div>
            <button class="wallet-btn">Buy/Sell</button>
          </div>
          <div class="wallet-item">

          </div>
          <div class="wallet-item">

          </div>


        </div>
      </div>
      <!-- Chat tab -->
      <div id="tab-chat" class="tab-content" style="display:none;">
        <div class="chat-header">
          <input class="chat-search" type="text" placeholder="Find friends or clubs...">
          <span class="chat-bell">🔔</span>
        </div>
        <div class="chat-tabs">
          <button class="chat-tab active">My room</button>
          <button class="chat-tab" id="newClubBtn">New club</button>
        </div>
        <div class="chat-notify">
          <span>Stay up to date with friend.tech by turning on notifications</span>
          <button class="chat-notify-btn">Turn on</button>
        </div>
        <div class="chat-list">
          <div class="chat-item">
            <img src="https://randomuser.me/api/portraits/men/32.jpg" class="chat-avatar" alt="avatar">
            <div class="chat-info">
              <div class="chat-name">Smirnoff</div>
              <div class="chat-msg">Send them their first message</div>
            </div>
            <div class="chat-price">$0.00</div>
          </div>
        </div>
      </div>
      <!-- Discover tab (заглушка) -->
      <div id="tab-discover" class="tab-content" style="display:none;">
        <div class="discover-tabs">
          <button class="discover-tab active" id="discoverRankingsBtn">Rankings</button>
          <button class="discover-tab" id="discoverRecentBtn">Recent</button>
        </div>
        <div id="discover-rankings" class="discover-list">
          <!-- Примерные данные, можно расширить -->
          <div class="discover-item">
            <div class="discover-rank">1</div>
            <img class="discover-avatar" src="https://randomuser.me/api/portraits/men/1.jpg" alt="club">
            <div class="discover-info">
              <div class="discover-title">WLM CLUB</div>
              <div class="discover-desc">Public club</div>
            </div>
            <div class="discover-price">Price: 0.0029 $POST</div>
          </div>
          <div class="discover-item">
            <div class="discover-rank">2</div>
            <img class="discover-avatar" src="https://randomuser.me/api/portraits/men/2.jpg" alt="club">
            <div class="discover-info">
              <div class="discover-title">Brutalist World Order</div>
              <div class="discover-desc">Public club</div>
            </div>
            <div class="discover-price">Price: 0.0027 $POST</div>
          </div>
          <div class="discover-item">
            <div class="discover-rank">3</div>
            <img class="discover-avatar" src="https://randomuser.me/api/portraits/men/3.jpg" alt="club">
            <div class="discover-info">
              <div class="discover-title">infinite</div>
              <div class="discover-desc">Public club</div>
            </div>
            <div class="discover-price">Price: 0.0025 $POST</div>
          </div>
          <div class="discover-item">
            <div class="discover-rank">4</div>
            <img class="discover-avatar" src="https://randomuser.me/api/portraits/men/4.jpg" alt="club">
            <div class="discover-info">
              <div class="discover-title">Auto Giveaways by F...</div>
              <div class="discover-desc">Public club</div>
            </div>
            <div class="discover-price">Price: 0.0023 $POST</div>
          </div>
          <div class="discover-item">
            <div class="discover-rank">5</div>
            <img class="discover-avatar" src="https://randomuser.me/api/portraits/men/5.jpg" alt="club">
            <div class="discover-info">
              <div class="discover-title">Onchain Friends</div>
              <div class="discover-desc">Public club</div>
            </div>
            <div class="discover-price">Price: 0.0021 $POST</div>
          </div>
          <!-- ... ещё элементы ... -->
        </div>
        <div id="discover-recent" class="discover-list" style="display:none;">
          <div style="color:#888; font-size:1.1rem; margin:40px auto; text-align:center;">Recent clubs coming soon...
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Модалка для New club -->
  <div id="clubModal" class="modal">
    <div class="modal-content create-club-modal-content">
      <span class="close" id="closeClubModal">&times;</span>
      <h2 style="margin-top:0;">Create club</h2>
      <div class="create-club-form">
        <label class="create-club-photo-label">
          <input type="file" id="clubPhotoInput" accept="image/*" style="display:none;">
          <div id="clubPhotoPreview" class="create-club-photo-preview">Tap to add<br>photo</div>
        </label>
        <div class="create-club-row">
          <input type="text" id="clubNameInput" class="create-club-input" placeholder="Name">
          <input type="text" id="clubTickerInput" class="create-club-input" placeholder="$TICKER" maxlength="8"
            style="text-transform:uppercase;">
        </div>
        <textarea id="clubDescInput" class="create-club-input" placeholder="Add a description for your club (optional)"
          style="resize:none;"></textarea>
        <div class="create-club-section-label">Select price curve</div>
        <div class="create-club-curves">
          <div class="curve-option selected" data-curve="casual">
            <svg width="48" height="32">
              <polyline points="0,28 16,24 32,20 48,8" fill="none" stroke="#22c55e" stroke-width="3" />
            </svg>
            <div>Casual</div>
          </div>
          <div class="curve-option" data-curve="standard">
            <svg width="48" height="32">
              <polyline points="0,28 12,24 24,16 36,8 48,4" fill="none" stroke="#a855f7" stroke-width="3" />
            </svg>
            <div>Standard</div>
          </div>
          <div class="curve-option" data-curve="exclusive">
            <svg width="48" height="32">
              <polyline points="0,28 8,24 16,20 32,16 40,8 48,0" fill="none" stroke="#fbbf24" stroke-width="3" />
            </svg>
            <div>Exclusive</div>
          </div>
        </div>
        <div class="create-club-section-label" style="margin-top:18px;">Buy club keys</div>
        <div class="create-club-row">
          <input type="number" id="clubKeysInput" class="create-club-input" value="1" min="1" max="10"
            style="width:80px;">
          <div style="margin-left:12px; color:#888; font-size:0.98rem;">Be the first holder of your club key. The first
            key is free.</div>
        </div>
        <div class="create-club-row" style="margin-top:8px; align-items:center;">
          <div style="color:#888; font-size:0.98rem;">You will spend:</div>
          <div style="margin-left:8px; color:#00bfff; font-weight:600; font-size:1.1rem;">--</div>
          <div style="margin-left:24px; color:#888; font-size:0.98rem;">Your balance:</div>
          <div style="margin-left:8px; color:#00bfff; font-weight:600; font-size:1.1rem;">0.9000</div>
        </div>
        <button class="create-club-btn" id="createClubBtn">Approve spending $POST</button>
        <div style="color:#aaa; font-size:0.95rem; margin-top:10px; text-align:center;">Once you create your club, you
          cannot change these details</div>
      </div>
    </div>
  </div>
  <!-- Модалка для чата клуба -->
  <div id="clubChatModal" class="modal">
    <div class="modal-content club-chat-modal-content">
      <span class="close" id="closeClubChatModal">&times;</span>
      <div class="club-chat-header">
        <img id="clubChatAvatar" class="club-chat-avatar" src="" alt="avatar">
        <span id="clubChatTitle" class="club-chat-title"></span>
      </div>
      <div id="clubChatMessages" class="club-chat-messages"></div>
      <form id="clubChatForm" class="club-chat-form">
        <input id="clubChatInput" type="text" placeholder="Write something..." autocomplete="off">
        <button type="submit" class="club-chat-send-btn">➤</button>
      </form>
    </div>
  </div>
  <!-- Модалка для кода доступа к Discover-чату -->
  <div id="discoverCodeModal" class="modal">
    <div class="modal-content" style="max-width:340px;">
      <span class="close" id="closeDiscoverCodeModal">&times;</span>
      <h2>Enter access code</h2>
      <input type="text" id="discoverCodeInput" placeholder="Access code"
        style="padding:10px; border-radius:6px; border:1px solid #ddd; width:100%; margin-bottom:12px; font-size:1rem;">
      <div id="discoverCodeError" style="color:#e00; font-size:0.98rem; min-height:22px; margin-bottom:8px;"></div>
      <button id="discoverCodeSubmit" class="wallet-btn" style="width:100%;">Enter</button>
    </div>
  </div>
  <!-- Фуллскрин чат -->
  <div id="fullscreenChat" class="fullscreen-chat">
    <div class="fschat-header">
      <div class="fschat-header-left">
        <button id="closeFullscreenChat" class="fschat-back">&#8592;</button>
        <img id="fullscreenChatAvatar" class="fschat-avatar" src="" alt="avatar">
        <span id="fullscreenChatTitle" class="fschat-title"></span>
      </div>
      <div class="fschat-header-right">
        <button class="fschat-balance"><img src="images/logo2.png"
            style="width:18px;vertical-align:middle;margin-right:4px;">0.0000</button>
        <div class="fschat-menu-wrap">
          <button class="fschat-menu-btn">⋮</button>
          <div class="fschat-menu">
            <div class="fschat-menu-item">Share link</div>
            <div class="fschat-menu-item">Turn on notifications</div>
            <div class="fschat-menu-item">Pin to top of chat list</div>
          </div>
        </div>
      </div>
    </div>
    <div id="fullscreenChatMessages" class="fschat-messages"></div>
    <div class="fschat-tip">Tip: Chat with your key holders here. They can see your messages and only you can see their
      messages, unless you reply</div>
    <form id="fullscreenChatForm" class="fschat-form" style="position:relative;">
      <button type="button" class="fschat-emoji" style="background: none; border: none; padding: 0; cursor: pointer;">
        <img
          src="https://toppng.com/uploads/preview/font-emoji-svg-png-icon-free-download-389350-onlinewebfonts-play-button-image-11563230644rbzu7hlann.png"
          alt="emoji" style="width: 24px; height: 24px; opacity: 0.7;">
      </button>
      <div class="emoji-panel">
        <button type="button" class="emoji-btn" data-emoji="👍"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/thumbs-up_1f44d.png" alt="👍"></button>
        <button type="button" class="emoji-btn" data-emoji="❤️"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/red-heart_2764-fe0f.png" alt="❤️"></button>
        <button type="button" class="emoji-btn" data-emoji="😊"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/smiling-face-with-smiling-eyes_1f60a.png"
            alt="😊"></button>
        <button type="button" class="emoji-btn" data-emoji="🎉"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/party-popper_1f389.png" alt="🎉"></button>
        <button type="button" class="emoji-btn" data-emoji="👋"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/waving-hand_1f44b.png" alt="👋"></button>
        <button type="button" class="emoji-btn" data-emoji="🔥"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/fire_1f525.png" alt="🔥"></button>
        <button type="button" class="emoji-btn" data-emoji="😂"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/face-with-tears-of-joy_1f602.png" alt="😂"></button>
        <button type="button" class="emoji-btn" data-emoji="🤔"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/thinking-face_1f914.png" alt="🤔"></button>
        <button type="button" class="emoji-btn" data-emoji="✨"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/sparkles_2728.png" alt="✨"></button>
        <button type="button" class="emoji-btn" data-emoji="😍"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/smiling-face-with-heart-eyes_1f60d.png"
            alt="😍"></button>
        <button type="button" class="emoji-btn" data-emoji="🙌"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/raising-hands_1f64c.png" alt="🙌"></button>
        <button type="button" class="emoji-btn" data-emoji="💪"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/flexed-biceps_1f4aa.png" alt="💪"></button>
        <button type="button" class="emoji-btn" data-emoji="🎯"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/direct-hit_1f3af.png" alt="🎯"></button>
        <button type="button" class="emoji-btn" data-emoji="💯"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/hundred-points_1f4af.png" alt="💯"></button>
        <button type="button" class="emoji-btn" data-emoji="⭐"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/star_2b50.png" alt="⭐"></button>
        <button type="button" class="emoji-btn" data-emoji="💡"><img
            src="https://em-content.zobj.net/thumbs/120/apple/325/light-bulb_1f4a1.png" alt="💡"></button>
      </div>
      <button type="button" class="fschat-img-btn" id="fschatImgBtn"
        style="background: none; border: none; padding: 0; cursor: pointer;">
        <img src="https://static.thenounproject.com/png/1034957-200.png" alt="add image"
          style="width: 24px; height: 24px; opacity: 0.7;">
      </button>
      <input type="file" id="fschatImgInput" accept="image/*" style="display:none;">
      <input id="fullscreenChatInput" type="text" placeholder="Write something..." autocomplete="off"
        style="margin-left:8px;">
      <button type="submit" class="fschat-send" style="background: none; border: none; padding: 0; cursor: pointer;">
        <img src="https://static-00.iconduck.com/assets.00/send-icon-2048x2048-h9h456ci.png" alt="send"
          style="width: 24px; height: 24px; opacity: 0.7;">
      </button>
    </form>
  </div>
  <!-- Firebase App (core) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <!-- Firebase Auth -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <!-- Firebase Firestore -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <!-- Firebase Storage -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

  <script>
    // Проверяем, не инициализирован ли уже Firebase
    if (!firebase.apps.length) {
      const firebaseConfig = {
        apiKey: "AIzaSyCuL4tpaSsw1ylXf2VZrQ1b_2t_Kxd97cI",
        authDomain: "post-ad037.firebaseapp.com",
        projectId: "post-ad037",
        storageBucket: "post-ad037.firebasestorage.app",
        messagingSenderId: "377312187432",
        appId: "1:377312187432:web:565f47c145e0e73ac0911d",
        measurementId: "G-T48NR3B9VW"
      };
      firebase.initializeApp(firebaseConfig);
    }

    // Initialize Storage
    const storage = firebase.storage();

    const modal = document.getElementById('modal');
    const loginBtn = document.querySelector('.login-btn');
    const closeModal = document.getElementById('closeModal');
    const twitterLogin = document.getElementById('twitterLogin');
    const registerForm = document.getElementById('registerForm');
    const loginForm = document.getElementById('loginForm');
    const showLoginForm = document.getElementById('showLoginForm');
    const showRegisterForm = document.getElementById('showRegisterForm');

    loginBtn.onclick = () => { modal.style.display = 'flex'; }
    closeModal.onclick = () => { modal.style.display = 'none'; }
    window.onclick = (e) => { if (e.target == modal) modal.style.display = 'none'; }

    // --- Firebase config (замените на свои значения) ---
    const firebaseConfig = {

      apiKey: "AIzaSyCuL4tpaSsw1ylXf2VZrQ1b_2t_Kxd97cI",

      authDomain: "post-ad037.firebaseapp.com",

      projectId: "post-ad037",

      storageBucket: "post-ad037.firebasestorage.app",

      messagingSenderId: "377312187432",

      appId: "1:377312187432:web:565f47c145e0e73ac0911d",

      measurementId: "G-T48NR3B9VW"

    };

    firebase.initializeApp(firebaseConfig);
    const provider = new firebase.auth.TwitterAuthProvider();

    twitterLogin.onclick = () => {
      firebase.auth().signInWithPopup(provider)
        .then((result) => {
          const user = result.user;
          alert('Добро пожаловать, ' + user.displayName + '!');
          modal.style.display = 'none';
          document.querySelector('.container').style.display = 'none';
          document.getElementById('wallet').style.display = 'none';
          document.getElementById('main-app').style.display = 'flex';
          showTab('chat');
        })
        .catch((error) => {
          alert('Ошибка авторизации: ' + error.message);
        });
    };

    registerForm.onsubmit = function (e) {
      e.preventDefault();
      const email = registerForm.querySelector('input[type="email"]').value;
      const password = registerForm.querySelector('input[type="password"]').value;
      firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Пользователь зарегистрирован и автоматически залогинен
          modal.style.display = 'none';
          document.querySelector('.container').style.display = 'none';
          document.getElementById('wallet').style.display = 'none';
          document.getElementById('main-app').style.display = 'flex';
          showTab('chat');
        })
        .catch((error) => {
          if (error.code === 'auth/email-already-in-use') {
            alert('Этот email уже зарегистрирован. Пожалуйста, войдите.');
            // Переключаем на форму входа и подставляем email
            registerForm.style.display = 'none';
            loginForm.style.display = '';
            showLoginForm.style.display = 'none';
            showRegisterForm.style.display = '';
            loginForm.querySelector('input[type="email"]').value = email;
            loginForm.querySelector('input[type="password"]').focus();
          } else {
            alert('Ошибка регистрации: ' + error.message);
          }
        });
    };

    // Переключение вкладок
    function showTab(tab) {
      document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
      document.getElementById('tab-' + tab).style.display = 'block';
      document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
      document.querySelector('.sidebar-item[data-tab="' + tab + '"]').classList.add('active');
    }
    document.querySelectorAll('.sidebar-item').forEach(item => {
      item.onclick = function () {
        showTab(this.getAttribute('data-tab'));
      };
    });

    // --- New club modal logic ---
    const newClubBtn = document.getElementById('newClubBtn');
    const clubModal = document.getElementById('clubModal');
    const closeClubModal = document.getElementById('closeClubModal');
    const clubCodeInput = document.getElementById('clubCodeInput');
    const clubCodeSubmit = document.getElementById('clubCodeSubmit');
    const clubCodeError = document.getElementById('clubCodeError');

    // Добавляем модальное окно для ввода кода
    const codeModal = document.createElement('div');
    codeModal.id = 'codeModal';
    codeModal.className = 'modal';
    codeModal.innerHTML = `
      <div class="modal-content" style="max-width:340px;">
        <span class="close" id="closeCodeModal">&times;</span>
        <h2>Enter access code</h2>
        <input type="text" id="accessCodeInput" placeholder="Access code" style="padding:10px; border-radius:6px; border:1px solid #ddd; width:100%; margin-bottom:12px; font-size:1rem;">
        <div id="accessCodeError" style="color:#e00; font-size:0.98rem; min-height:22px; margin-bottom:8px;"></div>
        <button id="accessCodeSubmit" class="wallet-btn" style="width:100%;">Enter</button>
      </div>
    `;
    document.body.appendChild(codeModal);

    // Обработчики для модального окна с кодом
    const closeCodeModal = document.getElementById('closeCodeModal');
    const accessCodeInput = document.getElementById('accessCodeInput');
    const accessCodeError = document.getElementById('accessCodeError');
    const accessCodeSubmit = document.getElementById('accessCodeSubmit');

    if (newClubBtn) {
      newClubBtn.onclick = function () {
        // Показываем сначала окно для ввода кода
        codeModal.style.display = 'flex';
        accessCodeInput.value = '';
        accessCodeError.textContent = '';
        accessCodeInput.focus();
      };
    }

    if (closeCodeModal) {
      closeCodeModal.onclick = function () {
        codeModal.style.display = 'none';
      };
    }

    // Закрытие по клику вне модального окна
    window.addEventListener('click', function (e) {
      if (e.target === codeModal) {
        codeModal.style.display = 'none';
      }
      if (e.target === clubModal) {
        clubModal.style.display = 'none';
      }
    });

    if (accessCodeSubmit) {
      accessCodeSubmit.onclick = function () {
        const code = accessCodeInput.value.trim();
        if (code === 'oldcode') {
          accessCodeError.style.color = '#0a0';
          accessCodeError.textContent = 'Access granted!';
          setTimeout(() => {
            codeModal.style.display = 'none';
            accessCodeError.textContent = '';
            // Показываем модальное окно создания клуба
            clubModal.style.display = 'flex';
          }, 1000);
        } else {
          accessCodeError.style.color = '#e00';
          accessCodeError.textContent = 'Invalid code!';
        }
      };
    }

    if (closeClubModal) {
      closeClubModal.onclick = function () {
        clubModal.style.display = 'none';
      };
    }

    // --- Discover tab logic ---
    const discoverRankingsBtn = document.getElementById('discoverRankingsBtn');
    const discoverRecentBtn = document.getElementById('discoverRecentBtn');
    const discoverRankings = document.getElementById('discover-rankings');
    const discoverRecent = document.getElementById('discover-recent');
    if (discoverRankingsBtn && discoverRecentBtn) {
      discoverRankingsBtn.onclick = function () {
        discoverRankingsBtn.classList.add('active');
        discoverRecentBtn.classList.remove('active');
        discoverRankings.style.display = '';
        discoverRecent.style.display = 'none';
      };
      discoverRecentBtn.onclick = function () {
        discoverRecentBtn.classList.add('active');
        discoverRankingsBtn.classList.remove('active');
        discoverRankings.style.display = 'none';
        discoverRecent.style.display = '';
      };
    }

    // --- Firebase auto-login ---
    firebase.auth().onAuthStateChanged(function (user) {
      if (user) {
        document.querySelector('.container').style.display = 'none';
        document.getElementById('wallet').style.display = 'none';
        document.getElementById('main-app').style.display = 'flex';
        showTab('chat');

        // Обновляем аватар пользователя
        const profileAvatar = document.querySelector('.wallet-profile-avatar');
        if (profileAvatar) {
          profileAvatar.src = user.photoURL || 'https://e7.pngegg.com/pngimages/178/595/png-clipart-user-profile-computer-icons-login-user-avatars-monochrome-black-thumbnail.png';
        }

        // Обновляем имя пользователя
        const profileName = document.querySelector('.wallet-profile-name');
        if (profileName) {
          // Генерируем случайное число для ID пользователя
          const randomId = Math.floor(Math.random() * 10000);
          if (user.providerData && user.providerData[0]?.providerId === 'twitter.com') {
            // Если пользователь вошел через Twitter
            profileName.innerHTML = `${user.displayName}<span class="wallet-profile-handle">@${user.providerData[0].username || user.displayName}</span>`;
          } else {
            // Если пользователь вошел через email/password
            profileName.innerHTML = `User<span class="wallet-profile-handle">@user_${randomId}</span>`;
          }
        }

        // Обновляем информацию о Twitter
        const twitterInfo = document.querySelector('.wallet-profile-twitter');
        if (twitterInfo) {
          if (user.providerData && user.providerData[0]?.providerId === 'twitter.com') {
            // Если пользователь вошел через Twitter, показываем ссылку
            const username = user.providerData[0].username || user.displayName;
            twitterInfo.innerHTML = `<a href="https://twitter.com/${username}" style="color:#00bfff;">@${username}</a> <span style="color:#00bfff;">✔️</span>`;
          } else {
            // Если не через Twitter - скрываем блок
            twitterInfo.style.display = 'none';
          }
        }
      } else {
        document.querySelector('.container').style.display = '';
        document.getElementById('wallet').style.display = 'none';
        document.getElementById('main-app').style.display = 'none';
        // Показываем только форму регистрации по умолчанию
        document.getElementById('registerForm').style.display = '';
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('showLoginForm').style.display = '';
        document.getElementById('showRegisterForm').style.display = 'none';
      }
    });

    // --- Обработчик выхода из аккаунта ---
    const logoutBtn = document.querySelector('.wallet-logout-btn');
    if (logoutBtn) {
      logoutBtn.onclick = function () {
        firebase.auth().signOut()
          .then(() => {
            // Возвращаем на главный экран
            document.querySelector('.container').style.display = '';
            document.getElementById('wallet').style.display = 'none';
            document.getElementById('main-app').style.display = 'none';
            // Сбрасываем формы
            document.getElementById('registerForm').reset();
            document.getElementById('loginForm').reset();
            // Показываем форму регистрации
            document.getElementById('registerForm').style.display = '';
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('showLoginForm').style.display = '';
            document.getElementById('showRegisterForm').style.display = 'none';
          })
          .catch((error) => {
            alert('Ошибка при выходе: ' + error.message);
          });
      };
    }

    // --- Логика переключения между регистрацией и входом ---
    // Повторные объявления переменных удалены, используем уже объявленные выше
    if (showLoginForm && showRegisterForm && registerForm && loginForm) {
      showLoginForm.onclick = function (e) {
        e.preventDefault();
        // Показываем модальное окно
        modal.style.display = 'flex';
        // Получаем email из формы регистрации, если есть
        const regEmail = registerForm.querySelector('input[type="email"]').value;
        registerForm.style.display = 'none';
        loginForm.style.display = '';
        showLoginForm.style.display = 'none';
        showRegisterForm.style.display = '';
        // Подставляем email, если был введён
        if (regEmail) {
          loginForm.querySelector('input[type="email"]').value = regEmail;
        }
        loginForm.querySelector('input[type="password"]').focus();
      };
      showRegisterForm.onclick = function (e) {
        e.preventDefault();
        registerForm.style.display = '';
        loginForm.style.display = 'none';
        showLoginForm.style.display = '';
        showRegisterForm.style.display = 'none';
        // Автофокус на email
        registerForm.querySelector('input[type="email"]').focus();
      };
    }
    // --- Вход через email/password ---
    loginForm.onsubmit = function (e) {
      e.preventDefault();
      const email = loginForm.querySelector('input[type="email"]').value;
      const password = loginForm.querySelector('input[type="password"]').value;
      firebase.auth().signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Скрываем модальное окно и начальный контейнер
          modal.style.display = 'none';
          document.querySelector('.container').style.display = 'none';
          // Скрываем кошелек
          document.getElementById('wallet').style.display = 'none';
          // Показываем основное приложение
          document.getElementById('main-app').style.display = 'flex';
          // Переключаемся на вкладку чата
          showTab('chat');
        })
        .catch((error) => {
          alert('Ошибка входа: ' + error.message);
        });
    };

    // Закрытие модалки Create club
    const closeCreateClubModal = document.getElementById('closeCreateClubModal');
    if (closeCreateClubModal) {
      closeCreateClubModal.onclick = function () {
        document.getElementById('createClubModal').style.display = 'none';
      };
    }

    // Загрузка и предпросмотр фото
    document.getElementById('clubPhotoPreview').onclick = function () {
      document.getElementById('clubPhotoInput').click();
    };

    document.getElementById('clubPhotoInput').onchange = function (e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (ev) {
          document.getElementById('clubPhotoPreview').innerHTML = '<img src="' + ev.target.result + '" style="width:100%;height:100%;object-fit:cover;border-radius:12px;">';
        };
        reader.readAsDataURL(file);
      }
    };

    // Выбор кривой цены
    document.querySelectorAll('.curve-option').forEach(opt => {
      opt.onclick = function () {
        document.querySelectorAll('.curve-option').forEach(o => o.classList.remove('selected'));
        this.classList.add('selected');
      };
    });

    // --- Клубы ---
    function getClubs() {
      try {
        return JSON.parse(localStorage.getItem('clubs') || '[]');
      } catch { return []; }
    }
    function saveClubs(clubs) {
      localStorage.setItem('clubs', JSON.stringify(clubs));
    }
    function renderClubs() {
      const chatList = document.querySelector('.chat-list');
      if (!chatList) return;
      // Оставляем только первый (примерный) чат
      const staticChat = chatList.querySelector('.chat-item');
      chatList.innerHTML = '';
      if (staticChat) chatList.appendChild(staticChat);
      const clubs = getClubs();
      clubs.forEach(club => {
        const div = document.createElement('div');
        div.className = 'chat-item';
        div.innerHTML = `
          <img src="${club.avatar || 'https://via.placeholder.com/40x40?text=Club'}" class="chat-avatar" alt="avatar">
          <div class="chat-info">
            <div class="chat-name">${club.name} <span style='color:#00bfff;font-size:0.95em;'>${club.ticker ? ('(' + club.ticker + ')') : ''}</span></div>
            <div class="chat-msg" style="white-space:pre-line;">${club.desc || ''}</div>
          </div>
          <div class="chat-price">$0.00</div>
        `;
        chatList.appendChild(div);
      });
    }
    // При загрузке страницы
    renderClubs();

    // --- Обработка создания клуба ---
    document.getElementById('createClubBtn').onclick = function () {
      const name = document.getElementById('clubNameInput').value.trim();
      const ticker = document.getElementById('clubTickerInput').value.trim().toUpperCase();
      const desc = document.getElementById('clubDescInput').value.trim();
      const avatarEl = document.getElementById('clubPhotoPreview').querySelector('img');
      const avatar = avatarEl ? avatarEl.src : '';
      if (!name || !ticker) {
        alert('Name and ticker are required!');
        return;
      }
      const clubs = getClubs();
      clubs.push({ name, ticker, desc, avatar });
      saveClubs(clubs);
      renderClubs();
      document.getElementById('createClubModal').style.display = 'none';
      // Сброс формы
      document.getElementById('clubNameInput').value = '';
      document.getElementById('clubTickerInput').value = '';
      document.getElementById('clubDescInput').value = '';
      document.getElementById('clubPhotoPreview').innerHTML = 'Tap to add<br>photo';
      document.getElementById('clubPhotoInput').value = '';
      document.querySelectorAll('.curve-option').forEach(o => o.classList.remove('selected'));
      document.querySelector('.curve-option[data-curve="casual"]').classList.add('selected');
    };

    // --- Открытие чата клуба ---
    let currentClubKey = null;
    document.querySelector('.chat-list').addEventListener('click', function (e) {
      let item = e.target;
      while (item && !item.classList.contains('chat-item')) item = item.parentElement;
      if (!item) return;
      // Пропускаем первый (статичный) чат
      const idx = Array.from(this.children).indexOf(item);
      if (idx === 0) return;
      const clubs = getClubs();
      const club = clubs[idx - 1];
      if (!club) return;
      currentClubKey = club.name + '|' + club.ticker;
      openFullscreenChat({
        avatar: club.avatar || 'https://via.placeholder.com/40x40?text=Club',
        title: club.name + (club.ticker ? ' (' + club.ticker + ')' : ''),
        key: currentClubKey
      });
    });

    // --- Открытие чата из Discover с кодом ---
    let discoverChatData = null;
    document.getElementById('discover-rankings').addEventListener('click', function (e) {
      let item = e.target;
      while (item && !item.classList.contains('discover-item')) item = item.parentElement;
      if (!item) return;
      const avatar = item.querySelector('.discover-avatar')?.src || '';
      const name = item.querySelector('.discover-title')?.textContent || '';
      const ticker = (item.querySelector('.discover-title')?.textContent.match(/\(([^)]+)\)/) || [])[1] || '';
      discoverChatData = {
        avatar,
        title: name + (ticker ? ' (' + ticker + ')' : ''),
        key: 'discover|' + name + '|' + ticker
      };

      // Проверяем, есть ли доступ у текущего пользователя к конкретному клубу
      const currentUser = firebase.auth().currentUser;
      if (currentUser) {
        const clubAccessKey = `club_access_${currentUser.uid}_${name.trim()}`;
        const hasAccess = localStorage.getItem(clubAccessKey) === 'true';

        if (hasAccess) {
          // Если доступ к этому клубу уже есть, сразу открываем чат
          openFullscreenChat(discoverChatData);
        } else {
          // Если доступа к этому клубу нет, показываем окно для ввода кода
          document.getElementById('discoverCodeModal').style.display = 'flex';
          document.getElementById('discoverCodeInput').value = '';
          document.getElementById('discoverCodeError').textContent = '';
          document.getElementById('discoverCodeInput').focus();
        }
      } else {
        // Если пользователь не авторизован, показываем окно для ввода кода
        document.getElementById('discoverCodeModal').style.display = 'flex';
        document.getElementById('discoverCodeInput').value = '';
        document.getElementById('discoverCodeError').textContent = '';
        document.getElementById('discoverCodeInput').focus();
      }
    });

    document.getElementById('closeDiscoverCodeModal').onclick = function () {
      document.getElementById('discoverCodeModal').style.display = 'none';
    };

    document.getElementById('discoverCodeSubmit').onclick = function () {
      const code = document.getElementById('discoverCodeInput').value.trim();
      if (code === 'oldcode') {
        document.getElementById('discoverCodeError').style.color = '#0a0';
        document.getElementById('discoverCodeError').textContent = 'Access granted!';

        // Сохраняем информацию о доступе для текущего пользователя к конкретному клубу
        const currentUser = firebase.auth().currentUser;
        if (currentUser && discoverChatData) {
          const clubName = discoverChatData.title.split('(')[0].trim();
          const clubAccessKey = `club_access_${currentUser.uid}_${clubName}`;
          localStorage.setItem(clubAccessKey, 'true');
        }

        setTimeout(() => {
          document.getElementById('discoverCodeModal').style.display = 'none';
          if (discoverChatData) openFullscreenChat(discoverChatData);
        }, 700);
      } else {
        document.getElementById('discoverCodeError').style.color = '#e00';
        document.getElementById('discoverCodeError').textContent = 'Invalid code!';
      }
    };

    // --- Web3 Chat: меню ---
    (function () {
      const menuBtn = document.querySelector('.fschat-menu-btn');
      const menuWrap = document.querySelector('.fschat-menu-wrap');
      if (menuBtn && menuWrap) {
        menuBtn.onclick = function (e) {
          e.stopPropagation();
          menuWrap.classList.toggle('open');
        };
        document.body.addEventListener('click', function () {
          menuWrap.classList.remove('open');
        });
      }
    })();

    // --- Web3 Chat: открытие ---
    function openFullscreenChat({ avatar, title, key }) {
      document.getElementById('fullscreenChatAvatar').src = avatar;
      document.getElementById('fullscreenChatTitle').textContent = title;
      currentClubKey = key;
      renderFullscreenChatMessages();
      document.getElementById('fullscreenChat').style.display = 'flex';
      document.querySelector('.main-app').style.display = 'none';
      setTimeout(() => {
        const msgBox = document.getElementById('fullscreenChatMessages');
        msgBox.scrollTop = msgBox.scrollHeight;
      }, 100);
    }
    document.getElementById('closeFullscreenChat').onclick = function () {
      document.getElementById('fullscreenChat').style.display = 'none';
      document.querySelector('.main-app').style.display = 'flex';
    };
    function getClubMessages(key) {
      try {
        return JSON.parse(localStorage.getItem('clubmsg_' + key) || '[]');
      } catch { return []; }
    }
    function saveClubMessages(key, msgs) {
      localStorage.setItem('clubmsg_' + key, JSON.stringify(msgs));
    }
    // --- Web3 Chat: сообщения ---
    const demoUsers = [
      { nick: 'Exo', avatar: 'https://randomuser.me/api/portraits/men/32.jpg' },
      { nick: '#roc', avatar: 'https://randomuser.me/api/portraits/men/33.jpg' },
      { nick: 'Gamb', avatar: 'https://randomuser.me/api/portraits/men/34.jpg' },
      { nick: 'Smiroff', avatar: 'https://randomuser.me/api/portraits/men/35.jpg' }
    ];
    function renderFullscreenChatMessages() {
      const box = document.getElementById('fullscreenChatMessages');
      box.innerHTML = '';
      if (!currentClubKey) return;
      let msgs = getClubMessages(currentClubKey);
      // Если сообщений нет, показываем демо-чат
      if (!msgs.length) {
        msgs = [
          { user: 0, text: 'Hahahha', time: '5/30/23 6:57PM' },
          { user: 0, text: 'Welcome', time: '5/30/23 6:57PM' },
          { user: 1, text: 'gm', time: '5/31/23 9:04AM' },
          { user: 2, text: 'gm', time: '6/1/23 9:07AM' },
          { user: 1, text: '把眼睛睁开，就会知道未来...', time: '6/1/23 9:07PM' },
          { user: 1, text: 'Best of luck!', time: '6/2/23 8:33AM' },
          { user: 3, text: '👀 💬', time: '6/2/23 8:34AM' }
        ];
      }
      msgs.forEach((m, i) => {
        const currentUser = firebase.auth().currentUser;
        const isMe = (m.user === 3) || (!m.user && m.nick === 'Smiroff') || (m.uid === currentUser?.uid);
        let userAvatar, userNick;

        if (isMe) {
          userAvatar = currentUser?.photoURL || 'https://e7.pngegg.com/pngimages/178/595/png-clipart-user-profile-computer-icons-login-user-avatars-monochrome-black-thumbnail.png';
          userNick = currentUser?.displayName || 'User';
        } else {
          const demoUser = demoUsers[m.user ?? 0] || demoUsers[0];
          userAvatar = m.avatar || demoUser.avatar;
          userNick = m.nick || demoUser.nick;
        }

        const row = document.createElement('div');
        row.className = 'fschat-message-row' + (isMe ? ' me' : '');
        row.innerHTML = `
          <div class="fschat-message${isMe ? ' me' : ''}">
            <div class="fschat-msg-header">
              <img class="fschat-msg-avatar" src="${userAvatar}" alt="avatar">
              <span class="fschat-msg-nick">${userNick}</span>
              <span class="fschat-msg-time">${m.time || ''}</span>
            </div>
            <div class="fschat-bubble">${m.text || ''}${m.img ? `<br><img src='${m.img}' style='max-width:180px;max-height:120px;border-radius:10px;margin-top:6px;'>` : ''}</div>
          </div>
        `;
        box.appendChild(row);
      });
      setTimeout(() => { box.scrollTop = box.scrollHeight; }, 50);
    }
    document.getElementById('fullscreenChatForm').onsubmit = function (e) {
      e.preventDefault();
      const input = document.getElementById('fullscreenChatInput');
      const text = input.value.trim();
      if ((!text && !imgToSend) || !currentClubKey) return;

      const currentUser = firebase.auth().currentUser;
      const msgs = getClubMessages(currentClubKey);
      const now = new Date();
      const time = now.toLocaleDateString() + ' ' + now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) + (now.getHours() >= 12 ? 'PM' : 'AM');

      const newMessage = {
        uid: currentUser?.uid,
        nick: currentUser?.displayName || 'User',
        avatar: currentUser?.photoURL,
        text,
        time
      };

      if (imgToSend) {
        newMessage.img = imgToSend;
      }

      msgs.push(newMessage);
      saveClubMessages(currentClubKey, msgs);
      input.value = '';
      clearImgPreview();
      renderFullscreenChatMessages();
    };

    // --- Emoji panel logic ---
    const chatEmojiPanel = document.getElementById('fschatEmojiPanel');
    const emojiBtn = document.querySelector('.fschat-emoji');
    const chatInput = document.getElementById('fullscreenChatInput');
    const emojiList = [
      '☺', '☻', '♡', '♥', '☀', '☁', '★', '☆', '☮', '☯', '☎', '⌨', '✉', '☑', '✓', '✔', '×', '≠', '∞', '♪', '♫', '⌘', '⌥', '⌦', '↵', '⇧', '⇪', '○', '◎', '●', '◐', '◑', '◒', '◓', '◌', '◍', '◉', '◊', '☘', '♣', '♠', '♦', '⚡', '☕', '✎', '✏', '✐', '✑', '✒', '✍', '✌', '⭐'
    ];
    emojiBtn.onclick = function (e) {
      e.preventDefault();
      chatEmojiPanel.innerHTML = '';
      emojiList.forEach(em => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'fschat-emoji-btn';
        btn.textContent = em;
        btn.onclick = function (ev) {
          ev.preventDefault();
          chatInput.value += em;
          chatEmojiPanel.style.display = 'none';
          chatInput.focus();
        };
        chatEmojiPanel.appendChild(btn);
      });
      chatEmojiPanel.style.display = chatEmojiPanel.style.display === 'none' ? 'flex' : 'none';
    };
    document.body.addEventListener('click', function (e) {
      if (!chatEmojiPanel.contains(e.target) && e.target !== emojiBtn) chatEmojiPanel.style.display = 'none';
    });

    // --- Image upload logic ---
    const imgBtn = document.getElementById('fschatImgBtn');
    const imgInput = document.getElementById('fschatImgInput');
    let imgToSend = null;
    imgBtn.onclick = function (e) {
      e.preventDefault();
      imgInput.click();
    };
    imgInput.onchange = function (e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (ev) {
          imgToSend = ev.target.result;
          // Показываем превью
          if (!document.getElementById('fschatImgPreview')) {
            const preview = document.createElement('img');
            preview.id = 'fschatImgPreview';
            preview.className = 'fschat-img-preview';
            preview.src = imgToSend;
            chatInput.parentNode.insertBefore(preview, chatInput);
          } else {
            document.getElementById('fschatImgPreview').src = imgToSend;
          }
        };
        reader.readAsDataURL(file);
      }
    };
    // Удалять превью при отправке или очистке
    function clearImgPreview() {
      imgToSend = null;
      const prev = document.getElementById('fschatImgPreview');
      if (prev) prev.remove();
      imgInput.value = '';
    }
    // --- Переключение между регистрацией и входом (как на friends-sand.vercel.app) ---
    (function () {
      const showLoginForm = document.getElementById('showLoginForm');
      const showRegisterForm = document.getElementById('showRegisterForm');
      const registerForm = document.getElementById('registerForm');
      const loginForm = document.getElementById('loginForm');
      if (showLoginForm && showRegisterForm && registerForm && loginForm) {
        showLoginForm.onclick = function (e) {
          e.preventDefault();
          registerForm.style.display = 'none';
          loginForm.style.display = '';
          showLoginForm.style.display = 'none';
          showRegisterForm.style.display = '';
          loginForm.querySelector('input[type="email"]').focus();
        };
        showRegisterForm.onclick = function (e) {
          e.preventDefault();
          registerForm.style.display = '';
          loginForm.style.display = 'none';
          showLoginForm.style.display = '';
          showRegisterForm.style.display = 'none';
          registerForm.querySelector('input[type="email"]').focus();
        };
      }
    })();
    // --- Конец блока переключения ---

    // Добавляем JavaScript для работы с эмодзи
    document.addEventListener('DOMContentLoaded', function () {
      const emojiButton = document.querySelector('.fschat-emoji');
      const emojiPanel = document.querySelector('.emoji-panel');
      const chatInput = document.getElementById('fullscreenChatInput');

      // Показать/скрыть панель эмодзи при клике на кнопку
      emojiButton.addEventListener('click', function (e) {
        e.stopPropagation();
        emojiPanel.style.display = emojiPanel.style.display === 'grid' ? 'none' : 'grid';
      });

      // Добавить эмодзи в поле ввода при клике
      document.querySelectorAll('.emoji-btn').forEach(btn => {
        btn.addEventListener('click', function (e) {
          e.stopPropagation();
          const emoji = this.getAttribute('data-emoji');
          const start = chatInput.selectionStart;
          const end = chatInput.selectionEnd;
          const text = chatInput.value;
          chatInput.value = text.substring(0, start) + emoji + text.substring(end);
          chatInput.focus();
          chatInput.selectionStart = chatInput.selectionEnd = start + emoji.length;
        });
      });

      // Закрыть панель при клике вне её
      document.addEventListener('click', function (e) {
        if (!emojiPanel.contains(e.target) && e.target !== emojiButton) {
          emojiPanel.style.display = 'none';
        }
      });
    });

    // Копирование адреса кошелька
    document.querySelector('.wallet-copy-btn').addEventListener('click', function () {
      const address = this.getAttribute('data-address');
      navigator.clipboard.writeText(address).then(() => {
        // Временно меняем title кнопки для обратной связи
        const originalTitle = this.title;
        this.title = 'Copied!';
        setTimeout(() => {
          this.title = originalTitle;
        }, 2000);
      }).catch(err => {
        console.error('Failed to copy:', err);
      });
    });

    // Функция для генерации адреса кошелька
    function generateWalletAddress() {
      const chars = '0123456789abcdef';
      let address = '0x';
      // Генерируем 40 символов (20 байт) для адреса Ethereum
      for (let i = 0; i < 40; i++) {
        address += chars[Math.floor(Math.random() * chars.length)];
      }
      return address;
    }

    // Функция для сокращения адреса (показывает первые 6 и последние 4 символа)
    function shortenAddress(address) {
      return address.slice(0, 6) + '...' + address.slice(-4);
    }

    // Функция обновления адреса в профиле
    function updateProfileAddress(user) {
      const addressElement = document.querySelector('.wallet-profile-addr');
      if (!addressElement) return;

      // Получаем сохраненный адрес или генерируем новый
      let walletAddress = localStorage.getItem(`wallet_address_${user.uid}`);
      if (!walletAddress) {
        walletAddress = generateWalletAddress();
        localStorage.setItem(`wallet_address_${user.uid}`, walletAddress);
      }

      // Обновляем отображение
      const shortenedAddress = shortenAddress(walletAddress);
      addressElement.innerHTML = `${shortenedAddress} <button class="wallet-copy-btn" data-address="${walletAddress}" title="Copy address"><img src="https://png.pngtree.com/png-vector/20190223/ourmid/pngtree-vector-copy-icon-png-image_695355.jpg" style="width:14px;height:14px;vertical-align:middle;"></button>`;

      // Добавляем обработчик копирования
      const copyBtn = addressElement.querySelector('.wallet-copy-btn');
      copyBtn.addEventListener('click', function () {
        const address = this.getAttribute('data-address');
        navigator.clipboard.writeText(address).then(() => {
          const originalTitle = this.title;
          this.title = 'Copied!';
          setTimeout(() => {
            this.title = originalTitle;
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy:', err);
        });
      });
    }

    // Обновляем обработчик авторизации
    firebase.auth().onAuthStateChanged(function (user) {
      if (user) {
        document.querySelector('.container').style.display = 'none';
        document.getElementById('wallet').style.display = 'none';
        document.getElementById('main-app').style.display = 'flex';
        showTab('chat');

        // Обновляем аватар пользователя
        const profileAvatar = document.querySelector('.wallet-profile-avatar');
        if (profileAvatar) {
          profileAvatar.src = user.photoURL || 'https://e7.pngegg.com/pngimages/178/595/png-clipart-user-profile-computer-icons-login-user-avatars-monochrome-black-thumbnail.png';
        }

        // Обновляем имя пользователя
        const profileName = document.querySelector('.wallet-profile-name');
        if (profileName) {
          const randomId = Math.floor(Math.random() * 10000);
          if (user.providerData && user.providerData[0]?.providerId === 'twitter.com') {
            profileName.innerHTML = `${user.displayName}<span class="wallet-profile-handle">@${user.providerData[0].username || user.displayName}</span>`;
          } else {
            profileName.innerHTML = `User<span class="wallet-profile-handle">@user_${randomId}</span>`;
          }
        }

        // Обновляем адрес кошелька
        updateProfileAddress(user);

        // Обновляем информацию о Twitter
        const twitterInfo = document.querySelector('.wallet-profile-twitter');
        if (twitterInfo) {
          if (user.providerData && user.providerData[0]?.providerId === 'twitter.com') {
            const username = user.providerData[0].username || user.displayName;
            twitterInfo.innerHTML = `<a href="https://twitter.com/${username}" style="color:#00bfff;">@${username}</a> <span style="color:#00bfff;">✔️</span>`;
          } else {
            twitterInfo.style.display = 'none';
          }
        }
      } else {
        document.querySelector('.container').style.display = '';
        document.getElementById('wallet').style.display = 'none';
        document.getElementById('main-app').style.display = 'none';
        document.getElementById('registerForm').style.display = '';
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('showLoginForm').style.display = '';
        document.getElementById('showRegisterForm').style.display = 'none';
      }
    });

    // Edit Profile Logic
    const editProfileBtn = document.querySelector('.wallet-profile-btn.edit-profile-trigger');
    const editProfileModal = document.getElementById('editProfileModal');
    const closeEditProfile = document.getElementById('closeEditProfile');
    const editProfileAvatar = document.getElementById('editProfileAvatar');
    const editProfileAvatarInput = document.getElementById('editProfileAvatarInput');
    const editProfileName = document.getElementById('editProfileName');
    const editProfileUsername = document.getElementById('editProfileUsername');
    const editProfileBio = document.getElementById('editProfileBio');
    const saveProfile = document.getElementById('saveProfile');
    const emojiTrigger = document.getElementById('emojiTrigger');
    const connectBtn = document.getElementById('connectPhantomBtn');
    const walletAddressEl = document.getElementById('walletAddress');
    const copyBtn = document.querySelector('.wallet-copy-btn');
    const profileEmojiPanel = document.getElementById('emojiPanel');

    // Setup emoji panel
    if (profileEmojiPanel && editProfileBio && emojiTrigger) {
      const emojis = ['😊', '😂', '🤣', '❤️', '😍', '🙌', '👍', '👋', '🎉', '✨', '🔥', '💯', '🤔', '👀', '🎈', '🌟', '💪', '🙏', '👏', '🌈'];

      // Clear existing content
      profileEmojiPanel.innerHTML = '';

      emojis.forEach(emoji => {
        const span = document.createElement('span');
        span.textContent = emoji;
        span.onclick = () => {
          const start = editProfileBio.selectionStart;
          const end = editProfileBio.selectionEnd;
          const text = editProfileBio.value;
          editProfileBio.value = text.substring(0, start) + emoji + text.substring(end);
          editProfileBio.focus();
          editProfileBio.selectionStart = editProfileBio.selectionEnd = start + emoji.length;
          profileEmojiPanel.style.display = 'none';
        };
        profileEmojiPanel.appendChild(span);
      });

      // Toggle emoji panel
      emojiTrigger.onclick = (e) => {
        e.preventDefault();
        e.stopPropagation();
        profileEmojiPanel.style.display = profileEmojiPanel.style.display === 'none' ? 'grid' : 'none';
      };

      // Close emoji panel when clicking outside
      document.addEventListener('click', (e) => {
        if (!profileEmojiPanel.contains(e.target) && e.target !== emojiTrigger) {
          profileEmojiPanel.style.display = 'none';
        }
      });
    }

    // Save profile handler
    if (saveProfile && editProfileModal) {
      saveProfile.onclick = function (e) {
        e.preventDefault();

        // Validate inputs
        const name = editProfileName?.value?.trim() || '';
        const username = editProfileUsername?.value?.trim() || '';
        const bio = editProfileBio?.value?.trim() || '';
        const avatar = editProfileAvatar?.src || '';

        if (!name || !username) {
          alert('Please fill in your name and username');
          return;
        }

        // Save profile data
        const profileData = { name, username, bio, avatar };
        localStorage.setItem('user_profile_data', JSON.stringify(profileData));

        // Update UI
        const nameElement = document.querySelector('.wallet-profile-name');
        const bioElement = document.querySelector('.wallet-profile-bio');
        const avatarElement = document.querySelector('.wallet-profile-avatar');
        const twitterElement = document.querySelector('.wallet-profile-twitter a');

        if (nameElement) {
          nameElement.innerHTML = `${name} <span class="wallet-profile-handle">@${username}</span>`;
        }
        if (bioElement) {
          bioElement.textContent = bio;
        }
        if (avatarElement) {
          avatarElement.src = avatar;
        }
        if (twitterElement) {
          twitterElement.textContent = `@${username}`;
          twitterElement.href = `https://twitter.com/${username}`;
        }

        // Close modal
        editProfileModal.style.display = 'none';
      };
    }

    // Modal close handlers
    if (closeEditProfile && editProfileModal) {
      closeEditProfile.onclick = function (e) {
        e.preventDefault();
        editProfileModal.style.display = 'none';
      };

      // Close on outside click
      window.onclick = function (e) {
        if (e.target === editProfileModal) {
          editProfileModal.style.display = 'none';
        }
      };
    }

    // Avatar upload handling
    if (editProfileAvatarInput && editProfileAvatar) {
      editProfileAvatarInput.onchange = function (e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (ev) {
            editProfileAvatar.src = ev.target.result;
          };
          reader.readAsDataURL(file);
        }
      };

      // Avatar overlay click handler
      const overlay = document.querySelector('.edit-profile-avatar-overlay');
      if (overlay) {
        overlay.onclick = (e) => {
          e.preventDefault();
          e.stopPropagation();
          editProfileAvatarInput.click();
        };
      }
    }
  </script>
  <!-- Edit Profile Modal -->
  <div id="editProfileModal" class="edit-profile-modal">
    <div class="edit-profile-header">
      <button class="edit-profile-back" id="closeEditProfile">←</button>
      <div class="edit-profile-title">Edit profile</div>
    </div>
    <div class="edit-profile-content">
      <div class="edit-profile-avatar-wrap">
        <img id="editProfileAvatar" class="edit-profile-avatar" src="" alt="avatar">
        <label class="edit-profile-avatar-overlay" for="editProfileAvatarInput">
          <img src="https://www.svgrepo.com/show/495939/camera.svg" class="edit-profile-camera-icon">
        </label>
        <input type="file" id="editProfileAvatarInput" accept="image/*" style="display:none;">
      </div>
      <div class="edit-profile-form-group">
        <label class="edit-profile-label">Name</label>
        <input type="text" id="editProfileName" class="edit-profile-input" placeholder="Enter your name">
      </div>
      <div class="edit-profile-form-group">
        <label class="edit-profile-label">Username</label>
        <input type="text" id="editProfileUsername" class="edit-profile-input" placeholder="Enter your username">
      </div>
      <button class="edit-profile-save" id="saveProfile">Save</button>
    </div>
  </div>

  <script>
    // Функция для сокращения адреса кошелька (0x98d8...a5ab)
    function formatAddress(address) {
      return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
    }

    // Функция для подключения к Phantom
    async function connectPhantom() {
      try {
        // Проверяем, установлен ли Phantom
        if (!window.solana || !window.solana.isPhantom) {
          alert('Пожалуйста, установите Phantom кошелек');
          window.open('https://phantom.app/', '_blank');
          return;
        }

        // Подключаемся к кошельку
        const resp = await window.solana.connect();
        const address = resp.publicKey.toString();

        // Обновляем UI
        const walletAddressEl = document.getElementById('walletAddress');
        const copyBtn = document.querySelector('.wallet-copy-btn');

        if (walletAddressEl && copyBtn) {
          walletAddressEl.textContent = formatAddress(address);
          copyBtn.dataset.address = address;
          copyBtn.style.display = 'inline-block';
        }

        // Сохраняем адрес в localStorage
        localStorage.setItem('phantomWallet', address);

      } catch (err) {
        console.error('Ошибка подключения к Phantom:', err);
        alert('Ошибка подключения к кошельку');
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      // Initialize UI elements
      const editProfileBtn = document.querySelector('.wallet-profile-btn.edit-profile-trigger');
      const editProfileModal = document.getElementById('editProfileModal');
      const closeEditProfile = document.getElementById('closeEditProfile');
      const editProfileAvatar = document.getElementById('editProfileAvatar');
      const editProfileAvatarInput = document.getElementById('editProfileAvatarInput');
      const editProfileName = document.getElementById('editProfileName');
      const editProfileUsername = document.getElementById('editProfileUsername');
      const editProfileBio = document.getElementById('editProfileBio');
      const saveProfile = document.getElementById('saveProfile');
      const emojiTrigger = document.getElementById('emojiTrigger');
      const connectBtn = document.getElementById('connectPhantomBtn');
      const walletAddressEl = document.getElementById('walletAddress');
      const copyBtn = document.querySelector('.wallet-copy-btn');
      const profileEmojiPanel = document.getElementById('emojiPanel');

      // Load saved profile data
      const storedData = localStorage.getItem('user_profile_data');
      if (storedData) {
        try {
          const profileData = JSON.parse(storedData);
          const nameElement = document.querySelector('.wallet-profile-name');
          const bioElement = document.querySelector('.wallet-profile-bio');
          const avatarElement = document.querySelector('.wallet-profile-avatar');
          const twitterElement = document.querySelector('.wallet-profile-twitter a');

          if (nameElement && profileData.name) {
            nameElement.innerHTML = `${profileData.name} <span class="wallet-profile-handle">@${profileData.username || 'username'}</span>`;
          }
          if (bioElement && profileData.bio) {
            bioElement.textContent = profileData.bio;
          }
          if (avatarElement && profileData.avatar) {
            avatarElement.src = profileData.avatar;
          }
          if (twitterElement && profileData.username) {
            twitterElement.textContent = `@${profileData.username}`;
            twitterElement.href = `https://twitter.com/${profileData.username}`;
          }
        } catch (err) {
          console.error('Error loading profile data:', err);
        }
      }

      // Load saved wallet address
      const savedAddress = localStorage.getItem('wallet_address');
      if (savedAddress) {
        const addressElement = document.querySelector('.wallet-profile-addr');
        if (addressElement) {
          const shortenedAddress = savedAddress.substring(0, 6) + '...' + savedAddress.substring(savedAddress.length - 4);
          addressElement.innerHTML = `${shortenedAddress} <button class="wallet-copy-btn" data-address="${savedAddress}" title="Copy address"><img src="images/copy-icon.png" style="width:14px;height:14px;vertical-align:middle;"></button>`;

          const newCopyBtn = addressElement.querySelector('.wallet-copy-btn');
          if (newCopyBtn) {
            newCopyBtn.addEventListener('click', function () {
              const addr = this.dataset.address;
              if (addr) {
                navigator.clipboard.writeText(addr)
                  .then(() => alert('Address copied'))
                  .catch(err => {
                    console.error('Copy error:', err);
                    // Fallback for non-HTTPS
                    const textarea = document.createElement('textarea');
                    textarea.value = addr;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                      document.execCommand('copy');
                      alert('Address copied');
                    } catch (e) {
                      console.error('Fallback copy failed:', e);
                      alert('Copy failed. Please copy manually.');
                    }
                    document.body.removeChild(textarea);
                  });
              }
            });
          }
        }
      }

      // Setup Phantom wallet
      if (connectBtn) {
        connectBtn.addEventListener('click', async function () {
          try {
            if (!window.solana || !window.solana.isPhantom) {
              alert('Please install Phantom wallet');
              window.open('https://phantom.app/', '_blank');
              return;
            }

            const resp = await window.solana.connect();
            const address = resp.publicKey.toString();

            // Save address
            localStorage.setItem('wallet_address', address);

            // Update UI
            const addressElement = document.querySelector('.wallet-profile-addr');
            if (addressElement) {
              const shortenedAddress = address.substring(0, 6) + '...' + address.substring(address.length - 4);
              addressElement.innerHTML = `${shortenedAddress} <button class="wallet-copy-btn" data-address="${address}" title="Copy address"><img src="images/copy-icon.png" style="width:14px;height:14px;vertical-align:middle;"></button>`;

              const newCopyBtn = addressElement.querySelector('.wallet-copy-btn');
              if (newCopyBtn) {
                newCopyBtn.addEventListener('click', function () {
                  const addr = this.dataset.address;
                  if (addr) {
                    navigator.clipboard.writeText(addr)
                      .then(() => alert('Address copied'))
                      .catch(err => {
                        console.error('Copy error:', err);
                        // Fallback for non-HTTPS
                        const textarea = document.createElement('textarea');
                        textarea.value = addr;
                        document.body.appendChild(textarea);
                        textarea.select();
                        try {
                          document.execCommand('copy');
                          alert('Address copied');
                        } catch (e) {
                          console.error('Fallback copy failed:', e);
                          alert('Copy failed. Please copy manually.');
                        }
                        document.body.removeChild(textarea);
                      });
                  }
                });
              }
            }
          } catch (err) {
            console.error('Error connecting to Phantom:', err);
            alert('Error connecting to wallet');
          }
        });
      }

      // Setup emoji panel
      if (profileEmojiPanel && editProfileBio && emojiTrigger) {
        const emojis = ['😊', '😂', '🤣', '❤️', '😍', '🙌', '👍', '👋', '🎉', '✨', '🔥', '💯', '🤔', '👀', '🎈', '🌟', '💪', '🙏', '👏', '🌈'];

        // Clear existing content
        profileEmojiPanel.innerHTML = '';

        emojis.forEach(emoji => {
          const span = document.createElement('span');
          span.textContent = emoji;
          span.onclick = () => {
            const start = editProfileBio.selectionStart;
            const end = editProfileBio.selectionEnd;
            const text = editProfileBio.value;
            editProfileBio.value = text.substring(0, start) + emoji + text.substring(end);
            editProfileBio.focus();
            editProfileBio.selectionStart = editProfileBio.selectionEnd = start + emoji.length;
            profileEmojiPanel.style.display = 'none';
          };
          profileEmojiPanel.appendChild(span);
        });

        // Toggle emoji panel
        emojiTrigger.onclick = (e) => {
          e.preventDefault();
          e.stopPropagation();
          profileEmojiPanel.style.display = profileEmojiPanel.style.display === 'none' ? 'grid' : 'none';
        };

        // Close emoji panel when clicking outside
        document.addEventListener('click', (e) => {
          if (!profileEmojiPanel.contains(e.target) && e.target !== emojiTrigger) {
            profileEmojiPanel.style.display = 'none';
          }
        });
      }
    });
  </script>
</body>

</html>
