<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firestore Chat</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      height: 100vh;
      background: #f0f2f5;
    }

    .fullscreen-chat {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      display: flex;
      flex-direction: column;
      z-index: 1000;
    }

    .fschat-header {
      background: #8b5cf6;
      color: white;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .fschat-header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .fschat-back {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 4px;
    }

    .fschat-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .fschat-title {
      font-size: 16px;
      font-weight: 600;
    }

    .fschat-header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .fschat-balance {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 6px 12px;
      border-radius: 16px;
      cursor: pointer;
      font-size: 14px;
    }

    .fschat-menu-wrap {
      position: relative;
    }

    .fschat-menu-btn {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 4px;
    }

    .fschat-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: none;
      min-width: 200px;
    }

    .fschat-menu.show {
      display: block;
    }

    .fschat-menu-item {
      padding: 12px 16px;
      cursor: pointer;
      color: #333;
      font-size: 14px;
    }

    .fschat-menu-item:hover {
      background: #f5f5f5;
    }

    .fschat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      background: #f0f2f5;
    }

    .fschat-tip {
      padding: 12px 16px;
      background: #f8f9fa;
      color: #666;
      font-size: 12px;
      text-align: center;
      border-top: 1px solid #e4e4e4;
    }

    .fschat-form {
      padding: 12px 16px;
      background: white;
      border-top: 1px solid #e4e4e4;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .fschat-emoji, .fschat-img-btn, .fschat-send {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    .fschat-emoji:hover, .fschat-img-btn:hover, .fschat-send:hover {
      opacity: 1;
    }

    .emoji-panel {
      position: absolute;
      bottom: 100%;
      left: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 8px;
      display: none;
      grid-template-columns: repeat(8, 1fr);
      gap: 4px;
    }

    .emoji-panel.show {
      display: grid;
    }

    .emoji-btn {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      border-radius: 4px;
    }

    .emoji-btn:hover {
      background: #f5f5f5;
    }

    .emoji-btn img {
      width: 24px;
      height: 24px;
    }

    #fullscreenChatInput {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #e4e4e4;
      border-radius: 20px;
      font-size: 14px;
      outline: none;
    }

    #fullscreenChatInput:focus {
      border-color: #8b5cf6;
    }

    .chat-message {
      margin-bottom: 16px;
      max-width: 70%;
    }

    .chat-message.sent {
      margin-left: auto;
    }

    .chat-message.received {
      margin-right: auto;
    }

    .message-content {
      background: white;
      padding: 12px 16px;
      border-radius: 16px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .chat-message.sent .message-content {
      background: #8b5cf6;
      color: white;
    }

    .message-sender {
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
    }

    .chat-message.sent .message-sender {
      text-align: right;
      color: rgba(255,255,255,0.8);
    }

    .message-time {
      font-size: 10px;
      color: #999;
      margin-top: 4px;
    }

    .chat-message.sent .message-time {
      color: rgba(255,255,255,0.8);
    }

    #error-message {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ef4444;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      z-index: 1000;
      display: none;
    }

    #error-message.show {
      display: block;
    }
  </style>
</head>
<body>

  <div id="fullscreenChat" class="fullscreen-chat">
    <div class="fschat-header">
      <div class="fschat-header-left">
        <button id="closeFullscreenChat" class="fschat-back">&#8592;</button>
        <img id="fullscreenChatAvatar" class="fschat-avatar" src="" alt="avatar">
        <span id="fullscreenChatTitle" class="fschat-title">Firestore Chat</span>
      </div>
      <div class="fschat-header-right">
        <button class="fschat-balance" title="Balance">
          <img src="images/logo2.png" style="width:18px;vertical-align:middle;margin-right:4px;">
          <span id="balance-display">0.0</span>
        </button>
        <div class="fschat-menu-wrap">
          <button class="fschat-menu-btn" title="Menu">‚ãÆ</button>
          <div class="fschat-menu">
            <div class="fschat-menu-item" onclick="copyInviteLink()">Copy chat link</div>
            <div class="fschat-menu-item">Delete chat</div>
            <div class="fschat-menu-item">Turn on notifications</div>
            <div class="fschat-menu-item">Pin to top of chat list</div>
          </div>
        </div>
      </div>
    </div>

    <div id="fullscreenChatMessages" class="fschat-messages"></div>
    <div class="fschat-tip">Tip: Chat with your key holders here. They can see your messages and only you can see their messages.</div>

    <form id="fullscreenChatForm" class="fschat-form">
      <button type="button" class="fschat-emoji">
        <img src="https://toppng.com/uploads/preview/font-emoji-svg-png-icon-free-download-389350-onlinewebfonts-play-button-image-11563230644rbzu7hlann.png" alt="emoji" style="width: 24px; height: 24px;">
      </button>
      <div class="emoji-panel">
        <button type="button" class="emoji-btn" data-emoji="üëç"><img src="https://em-content.zobj.net/thumbs/120/apple/325/thumbs-up_1f44d.png" alt="üëç"></button>
        <button type="button" class="emoji-btn" data-emoji="‚ù§Ô∏è"><img src="https://em-content.zobj.net/thumbs/120/apple/325/red-heart_2764-fe0f.png" alt="‚ù§Ô∏è"></button>
        <button type="button" class="emoji-btn" data-emoji="üòä"><img src="https://em-content.zobj.net/thumbs/120/apple/325/smiling-face-with-smiling-eyes_1f60a.png" alt="üòä"></button>
        <button type="button" class="emoji-btn" data-emoji="üéâ"><img src="https://em-content.zobj.net/thumbs/120/apple/325/party-popper_1f389.png" alt="üéâ"></button>
        <button type="button" class="emoji-btn" data-emoji="üëã"><img src="https://em-content.zobj.net/thumbs/120/apple/325/waving-hand_1f44b.png" alt="üëã"></button>
        <button type="button" class="emoji-btn" data-emoji="üî•"><img src="https://em-content.zobj.net/thumbs/120/apple/325/fire_1f525.png" alt="üî•"></button>
        <button type="button" class="emoji-btn" data-emoji="üòÇ"><img src="https://em-content.zobj.net/thumbs/120/apple/325/face-with-tears-of-joy_1f602.png" alt="üòÇ"></button>
        <button type="button" class="emoji-btn" data-emoji="ü§î"><img src="https://em-content.zobj.net/thumbs/120/apple/325/thinking-face_1f914.png" alt="ü§î"></button>
        <button type="button" class="emoji-btn" data-emoji="‚ú®"><img src="https://em-content.zobj.net/thumbs/120/apple/325/sparkles_2728.png" alt="‚ú®"></button>
        <button type="button" class="emoji-btn" data-emoji="üòç"><img src="https://em-content.zobj.net/thumbs/120/apple/325/smiling-face-with-heart-eyes_1f60d.png" alt="üòç"></button>
        <button type="button" class="emoji-btn" data-emoji="üôå"><img src="https://em-content.zobj.net/thumbs/120/apple/325/raising-hands_1f64c.png" alt="üôå"></button>
        <button type="button" class="emoji-btn" data-emoji="üí™"><img src="https://em-content.zobj.net/thumbs/120/apple/325/flexed-biceps_1f4aa.png" alt="üí™"></button>
        <button type="button" class="emoji-btn" data-emoji="üéØ"><img src="https://em-content.zobj.net/thumbs/120/apple/325/direct-hit_1f3af.png" alt="üéØ"></button>
        <button type="button" class="emoji-btn" data-emoji="üíØ"><img src="https://em-content.zobj.net/thumbs/120/apple/325/hundred-points_1f4af.png" alt="üíØ"></button>
        <button type="button" class="emoji-btn" data-emoji="‚≠ê"><img src="https://em-content.zobj.net/thumbs/120/apple/325/star_2b50.png" alt="‚≠ê"></button>
        <button type="button" class="emoji-btn" data-emoji="üí°"><img src="https://em-content.zobj.net/thumbs/120/apple/325/light-bulb_1f4a1.png" alt="üí°"></button>
      </div>
      <button type="button" class="fschat-img-btn" id="fschatImgBtn">
        <img src="https://static.thenounproject.com/png/1034957-200.png" alt="add image" style="width: 24px; height: 24px;">
      </button>
      <input type="file" id="fschatImgInput" accept="image/*" style="display:none;">
      <input id="fullscreenChatInput" type="text" placeholder="Write something..." autocomplete="off">
      <button type="submit" class="fschat-send">
        <img src="https://static-00.iconduck.com/assets.00/send-icon-2048x2048-h9h456ci.png" alt="send" style="width: 24px; height: 24px;">
      </button>
    </form>
  </div>

  <div id="error-message"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import {
      getFirestore,
      doc,
      collection,
      addDoc,
      onSnapshot,
      serverTimestamp,
      orderBy,
      query,
      setDoc,
      getDoc,
      updateDoc,
      arrayUnion,
      arrayRemove
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCuL4tpaSsw1ylXf2VZrQ1b_2t_Kxd97cI",
      authDomain: "post-ad037.firebaseapp.com",
      projectId: "post-ad037",
      storageBucket: "post-ad037.firebasestorage.app",
      messagingSenderId: "377312187432",
      appId: "1:377312187432:web:565f47c145e0e73ac0911d",
      measurementId: "G-T48NR3B9VW"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let currentUser = null;
    let userBalance = 0.0;
    let currentChatId = null;

    const errorDiv = document.getElementById('error-message');

    // –ü–æ–ª—É—á–∞–µ–º ID —á–∞—Ç–∞ –∏–∑ URL
    const urlParams = new URLSearchParams(window.location.search);
    currentChatId = urlParams.get('chat');

    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º ID —á–∞—Ç–∞
    const chatIdDisplay = document.getElementById('chat-id-display');
    if (currentChatId) {
      chatIdDisplay.textContent = `ID: ${currentChatId}`;
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
      const inviteLink = `${window.location.origin}${window.location.pathname}?chat=${currentChatId}`;
      document.getElementById('invite-link').value = inviteLink;
    } else {
      chatIdDisplay.textContent = 'ID: –Ω–µ —É–∫–∞–∑–∞–Ω';
      errorDiv.textContent = 'ID —á–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω –≤ URL. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä ?chat=ID_—á–∞—Ç–∞';
      document.getElementById('msg-form').style.display = 'none';
    }

    // –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
    const chatDocRef = doc(db, 'chats', currentChatId);
    const messagesRef = collection(chatDocRef, 'messages');
    const q = query(messagesRef, orderBy('timestamp'));

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —á–∞—Ç–∞ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    async function createChatStructure() {
      try {
        const chatDoc = await getDoc(chatDocRef);
        
        if (!chatDoc.exists()) {
          await setDoc(chatDocRef, {
            createdAt: serverTimestamp(),
            lastMessageAt: serverTimestamp(),
            participants: [currentUser.uid],
            isActive: true,
            title: `–ß–∞—Ç ${currentChatId}`,
            createdBy: currentUser.uid,
            chatId: currentChatId // –î–æ–±–∞–≤–ª—è–µ–º ID —á–∞—Ç–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç
          });
        } else {
          // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –µ—Å–ª–∏ –µ–≥–æ —Ç–∞–º –µ—â–µ –Ω–µ—Ç
          await updateDoc(chatDocRef, {
            participants: arrayUnion(currentUser.uid)
          });
        }
      } catch (err) {
        console.error('Error creating chat structure:', err);
        errorDiv.textContent = '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞: ' + err.message;
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
    window.copyInviteLink = function() {
      const inviteInput = document.getElementById('invite-link');
      inviteInput.select();
      document.execCommand('copy');
      alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
    };

    // –ê–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥
    signInAnonymously(auth)
      .then(() => {
        console.log('‚úÖ Anonymous sign-in successful');
        errorDiv.textContent = '';
      })
      .catch(err => {
        console.error('–û—à–∏–±–∫–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –≤—Ö–æ–¥–∞:', err);
        errorDiv.textContent = '–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: ' + err.message;
        document.getElementById('msg-form').style.display = 'none';
      });

    onAuthStateChanged(auth, async user => {
      if (user) {
        currentUser = user;
        console.log('üë§ Authenticated as', user.uid);
        errorDiv.textContent = '';

        if (!currentChatId) {
          errorDiv.textContent = 'ID —á–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω';
          return;
        }

        await createChatStructure();
        loadMessages();
        loadChatInfo();
      } else {
        currentUser = null;
        errorDiv.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
        document.getElementById('msg-form').style.display = 'none';
      }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ
    function loadChatInfo() {
      onSnapshot(chatDocRef, (doc) => {
        if (doc.exists()) {
          const data = doc.data();
          const participantsCount = data.participants?.length || 0;
          document.getElementById('participants-count').textContent = 
            `${participantsCount} —É—á–∞—Å—Ç–Ω–∏–∫${participantsCount !== 1 ? '–æ–≤' : ''}`;
        }
      });
    }

    // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    function displayMessage({ text, uid, name, timestamp }) {
      const chatBox = document.getElementById('fullscreenChatMessages');
      const div = document.createElement('div');
      const isSent = uid === currentUser?.uid;
      
      div.className = `chat-message ${isSent ? 'sent' : 'received'}`;
      
      const time = timestamp ? new Date(timestamp.toDate()).toLocaleTimeString() : 'Just now';
      
      div.innerHTML = `
        <div class="message-sender">${escapeHtml(name || 'User')}</div>
        <div class="message-content">${escapeHtml(text || '')}</div>
        <div class="message-time">${time}</div>
      `;
      
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
    function loadMessages() {
      onSnapshot(q, snapshot => {
        snapshot.docChanges().forEach(change => {
          if (change.type === 'added') {
            const msg = change.doc.data();
            displayMessage(msg);
          }
        });
      }, err => {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', err);
        errorDiv.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π: ' + err.message;
      });
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
    const msgForm = document.getElementById('msg-form');
    const msgInput = document.getElementById('msg-input');

    msgForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorDiv.textContent = '';

      if (!currentUser) {
        errorDiv.textContent = '–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.';
        return;
      }

      if (!currentChatId) {
        errorDiv.textContent = 'ID —á–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω.';
        return;
      }

      const text = msgInput.value.trim();
      if (!text) {
        errorDiv.textContent = '–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º.';
        return;
      }

      try {
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        await updateDoc(chatDocRef, {
          lastMessageAt: serverTimestamp()
        });

        await addDoc(messagesRef, {
          uid: currentUser.uid,
          name: 'Anon',
          text,
          timestamp: serverTimestamp(),
          chatId: currentChatId
        });

        userBalance += 0.1;
        document.getElementById('balance-display').textContent = userBalance.toFixed(1);
        msgInput.value = '';
      } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', err);
        errorDiv.textContent = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: ' + err.message;
      }
    });

    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
    function showError(message) {
      const errorDiv = document.getElementById('error-message');
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      setTimeout(() => {
        errorDiv.classList.remove('show');
      }, 3000);
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
    if (!currentChatId) {
      showError('ID —á–∞—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω –≤ URL. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä ?chat=ID_—á–∞—Ç–∞');
      document.getElementById('msg-form').style.display = 'none';
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —ç–º–æ–¥–∑–∏ –∏ –º–µ–Ω—é
    document.querySelector('.fschat-emoji').addEventListener('click', function() {
      document.querySelector('.emoji-panel').classList.toggle('show');
    });

    document.querySelector('.fschat-menu-btn').addEventListener('click', function() {
      document.querySelector('.fschat-menu').classList.toggle('show');
    });

    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.fschat-emoji')) {
        document.querySelector('.emoji-panel').classList.remove('show');
      }
      if (!e.target.closest('.fschat-menu-wrap')) {
        document.querySelector('.fschat-menu').classList.remove('show');
      }
    });

    // –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    document.querySelectorAll('.emoji-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const input = document.getElementById('fullscreenChatInput');
        input.value += this.dataset.emoji;
        input.focus();
      });
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    document.getElementById('fschatImgBtn').addEventListener('click', function() {
      document.getElementById('fschatImgInput').click();
    });
  </script>

</body>
</html>
